(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{350:function(e,t,n){"use strict";n.r(t);var a=n(12),i=n.n(a),r=n(13),o=n(17),u=n(0),l=n.n(u),c=n(16),d=n(199),s={};s.Box=Object(c.a)("div").withConfig({displayName:"style__Box",componentId:"sc-1ay69up-0"})(["margin:20px;> header{display:grid;grid-column-gap:10px;grid-template-columns:minmax(200px,auto) repeat(2,1fr);> section{flex:1;}}"]),s.Table=Object(c.a)(d.a).withConfig({displayName:"style__Table",componentId:"sc-1ay69up-1"})(["&&&{margin-top:20px;border-radius:5px;border-collapse:initial;overflow:hidden;border:1px solid rgba(224,224,224,1);> thead{background:",";> tr > th{color:",";}}}"],function(e){return e.theme.palette.grey[800]},function(e){return e.theme.palette.common.white}),s.Loading=Object(c.a)("section").withConfig({displayName:"style__Loading",componentId:"sc-1ay69up-2"})(["text-align:center;"]),s.ActionTableCell=Object(c.a)("section").withConfig({displayName:"style__ActionTableCell",componentId:"sc-1ay69up-3"})(["&&&{display:flex;> button{margin-right:8px;&:last-of-type{margin-right:0;}}}"]),s.HeaderBox=Object(c.a)("section").withConfig({displayName:"style__HeaderBox",componentId:"sc-1ay69up-4"})(["&&&{display:flex;flex-direction:column;> header{font-size:20px;font-weight:bold;margin-bottom:15px;}> section{font-weight:bold;font-size:14px;margin-bottom:10px;}> main{display:flex;align-items:center;> div{margin-right:10px;}}}"]),s.ImgPreview=Object(c.a)("section").withConfig({displayName:"style__ImgPreview",componentId:"sc-1ay69up-5"})(["width:180px;display:inline-flex;> img{width:80px;height:60px;}> section{display:flex;flex-direction:column;justify-content:center;align-items:center;margin-left:10px;}"]),s.SearchBox=Object(c.a)("div").withConfig({displayName:"style__SearchBox",componentId:"sc-1ay69up-6"})(["display:grid;grid-template-columns:4fr 3fr 2fr;grid-gap:12px;> span{grid-area:2 / 1 / 2 / 3;justify-self:end;align-self:center;}"]);var p=n(101),m=n(79),f=n(380),b=n(60),v=n(384),g=n(42),_=n(383),h=n(385),y=n(19),O=n(73),x=n(21),E=n(18);function j(){var e=Object(x.a)(["\n    query ($data: ProductSupplementListInput) {\n        product_supplement_list_total(productSupplementListInput: $data)\n        product_supplement_list(productSupplementListInput: $data) {\n            id\n            name\n            amount\n            number\n            user_id\n            state\n            create_time\n            addItemList {\n                id\n                name\n                count\n                amount\n                supplier\n                lastOutAmount\n                product {\n                    id\n                    number\n                    is_group\n                    name\n                    stock\n                    price_in\n                    price_out\n                    price_market\n                    weight\n                }\n            }\n        }\n    }\n"]);return j=function(){return e},e}function w(){var e=Object(x.a)(["\n    mutation ($data: ProductInput) {\n        save_product(ProductInput: $data) {\n            msg\n            flag\n            product {\n                id\n            }\n        }\n    }\n"]);return w=function(){return e},e}function k(){var e=Object(x.a)(["\n    query ($id: String) {\n        category_origin(id: $id) {\n            id number c2_id c2_name c3_id c3_name\n            c2_number c3_number\n        }\n    }\n"]);return k=function(){return e},e}function L(){var e=Object(x.a)(["\n      mutation($data: ProductSupplementInput) {\n          save_product_supplement (productSupplementInput: $data) {\n              msg\n              flag\n          }\n      }\n  "]);return L=function(){return e},e}var C={save_product_supplement:Object(E.b)(L())},I=(Object(E.b)(k()),Object(E.b)(w()),Object(E.b)(j())),P=n(30),F=n(398),T=Object(m.c)("AddProductList",{listData:[]},{getList:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var a,o,u,l,c,d,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.setData,u=n.query,l=n.data,e.next=3,u(I,Object(r.a)({},Object(m.e)(l),null!==(a=t)&&void 0!==a?a:{}));case 3:(c=e.sent)&&(d=c.product_supplement_list,s=c.product_supplement_list_total,o(Object(y.g)({total:s,listData:d})));case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),getAddProductList:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var a,o,u,l;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.query,e.next=3,o(F.a.getList,Object(r.a)({},t));case 3:if(u=e.sent,null===(l=null===u||void 0===u?void 0:null===(a=u.product_list)||void 0===a?void 0:a.filter(function(e){return e.stock<0}))||void 0===l?void 0:l.length){e.next=8;break}return Object(P.b)({message:"\u6682\u65e0\u9700\u8981\u8865\u8d27\u7684\u5546\u54c1"}),e.abrupt("return");case 8:return e.abrupt("return",l);case 9:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}),B=n(27),$=n(152),S=n(51),D=n(88),A=Object(B.b)(Object($.a)("wait",{id:"",waitList:[],state:1}),"waitListModal",{refreshData:function(){}},{setRefreshCall:function(e,t){return(0,t.setData)(Object(y.g)({refreshData:e}))},addOneProductSupplement:function(){var e=Object(o.a)(i.a.mark(function e(t,n){var a,o,u,l,c,d;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=n.data,c=n.mutate,e.next=3,c(C.save_product_supplement,{addList:l.modalData.waitList.map(function(e){return Object(r.a)({},Object(S.pick)(e,["addRemark","addNumber","addPrice","addSupplier"]),l.modalData.id?{id:e.id,product_id:e.product_id}:{product_id:e.id})}),id:l.modalData.id,state:null!==(a=t.state)&&void 0!==a?a:1,isGroup:null!==(o=t.isGroup)&&void 0!==o?o:0});case 3:return d=e.sent,(null===(u=d.save_product_supplement)||void 0===u?void 0:u.flag)&&(Object(P.b)({message:"\u64cd\u4f5c\u6210\u529f"}),l.refreshData()),e.abrupt("return",d);case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),isFinish:function(e,t){return t.data.modalData.state===D.d.Finish}}),N=n(327),G=n(433),q=n(321),H=n(39),R=function(e){var t;return Object(r.a)({},e.product,{lastOutAmount:e.lastOutAmount,addNumber:e.count,addPrice:e.amount,addSupplier:e.supplier,addRemark:e.remark,id:e.id,product_id:null===(t=e.product)||void 0===t?void 0:t.id})},M=function(e){var t,n=e.isGroup,a=Object(b.a)(),u=Object(O.a)(A),c=u.state,d=u.actions,s=d.setModal,m=c.modalData,f=c.fetchLoad[C.save_product_supplement],y=function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.addOneProductSupplement(t);case 2:if(!e.sent){e.next=4;break}d.onClose({});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return l.a.createElement(N.a,{fullWidth:!0,maxWidth:"lg",open:c.open,onClose:function(){return d.onClose({})}},l.a.createElement(q.a,null,"\u8865\u8d27\u5217\u8868"),l.a.createElement(G.a.Content,null,l.a.createElement(p.a.Table,{theme:a},l.a.createElement(_.a,null,l.a.createElement(v.a,null,["\u5546\u54c1\u7f16\u53f7","\u662f\u5426\u62fc\u56e2","\u4e2d\u6587\u540d\u79f0","\u5e93\u5b58","\u5e02\u573a\u4ef7\u683c","\u552e\u5356\u4ef7\u683c","\u8ba2\u5355\u9500\u552e\u4ef7\u683c"].map(function(e){return l.a.createElement(g.a,{key:"TableHead".concat(e)},e)}),l.a.createElement(g.a,{width:80},"\u8865\u8d27\u6570\u91cf"),l.a.createElement(g.a,{width:80},"\u8865\u8d27\u4ef7\u683c"),l.a.createElement(g.a,{width:100},"\u4f9b\u5e94\u5546"),l.a.createElement(g.a,{width:100},"\u5907\u6ce8"))),l.a.createElement(h.a,null,null===m||void 0===m?void 0:null===(t=m.waitList)||void 0===t?void 0:t.map(function(e,t){var n,a,i,o;return l.a.createElement(v.a,{key:"TableBody".concat(null===e||void 0===e?void 0:e.id)},l.a.createElement(g.a,null,null===e||void 0===e?void 0:e.number),l.a.createElement(g.a,null,(null===e||void 0===e?void 0:e.is_group)?"\u662f":"\u5426"),l.a.createElement(g.a,null,null===e||void 0===e?void 0:e.name),l.a.createElement(g.a,null,null===e||void 0===e?void 0:e.stock),l.a.createElement(g.a,null,null===e||void 0===e?void 0:e.price_market),l.a.createElement(g.a,null,null===e||void 0===e?void 0:e.price_out),l.a.createElement(g.a,null,null===e||void 0===e?void 0:e.lastOutAmount),l.a.createElement(g.a,null,l.a.createElement(G.a.TextFieldBox,{label:"",type:"number",disabled:d.isFinish(),value:null!==(n=null===e||void 0===e?void 0:e.addNumber)&&void 0!==n?n:"",onChange:function(e){return s(Object(r.a)({},m,{waitList:m.waitList.map(function(n,a){return a!==t?n:Object(r.a)({},n,{addNumber:parseFloat(e.target.value)})})}))}})),l.a.createElement(g.a,null,l.a.createElement(G.a.TextFieldBox,{disabled:d.isFinish(),label:"",type:"number",value:null!==(a=null===e||void 0===e?void 0:e.addPrice)&&void 0!==a?a:"",onChange:function(e){return s(Object(r.a)({},m,{waitList:m.waitList.map(function(n,a){return a!==t?n:Object(r.a)({},n,{addPrice:parseFloat(e.target.value)})})}))}})),l.a.createElement(g.a,null,l.a.createElement(G.a.TextFieldBox,{disabled:d.isFinish(),label:"",value:null!==(i=null===e||void 0===e?void 0:e.addSupplier)&&void 0!==i?i:"",onChange:function(e){return s(Object(r.a)({},m,{waitList:m.waitList.map(function(n,a){return a!==t?n:Object(r.a)({},n,{addSupplier:e.target.value})})}))}})),l.a.createElement(g.a,null,l.a.createElement(G.a.TextFieldBox,{disabled:d.isFinish(),label:"",value:null!==(o=null===e||void 0===e?void 0:e.addRemark)&&void 0!==o?o:"",onChange:function(e){return s(Object(r.a)({},m,{waitList:m.waitList.map(function(n,a){return a!==t?n:Object(r.a)({},n,{addRemark:e.target.value})})}))}})))}))),l.a.createElement("footer",null,m.id?l.a.createElement(l.a.Fragment,null,l.a.createElement(H.a,{loading:f?1:0,disabled:d.isFinish(),color:"primary",variant:"contained",fullWidth:!0,onClick:function(){return y({isGroup:n})}},"\u66f4\u65b0\u6570\u91cf"),l.a.createElement(H.a,{loading:f?1:0,color:"primary",variant:"contained",fullWidth:!0,onClick:function(){return y({state:d.isFinish()?1:2,isGroup:n})}},d.isFinish()?"\u64a4\u9500\u8865\u8d27":"\u786e\u5b9a\u8865\u8d27\u5b8c\u6210")):l.a.createElement(H.a,{loading:f?1:0,color:"primary",variant:"contained",fullWidth:!0,onClick:function(){return y({isGroup:n})}},"\u4fdd\u5b58"))))};n.d(t,"AddProduct",function(){return W});var W=function(e){var t,n=e.match,a=Object(b.a)(),c=Object(O.a)(T),d=c.state,x=c.actions,E=c.getLoad,j=E(I),w=d.listData,k=Object(O.a)(A).actions;return Object(u.useEffect)(function(){k.setRefreshCall(function(){var e;return x.getList({isGroup:~~(null===(e=n.params)||void 0===e?void 0:e.is_group)})})},[x,x.getList,n.params.is_group,k]),Object(u.useEffect)(function(){var e;x.getList({isGroup:~~(null===(e=n.params)||void 0===e?void 0:e.is_group)})},[x,n.params.is_group]),l.a.createElement(p.a.Box,null,l.a.createElement("header",null,l.a.createElement(p.a.HeaderBox,null,l.a.createElement("header",null,"\u8865\u8d27\u5217\u8868"),l.a.createElement("section",null,"\u60a8\u53ef\u4ee5\u8fdb\u884c\u7ba1\u7406"),l.a.createElement("main",null,l.a.createElement(H.a,{variant:"contained",color:"primary",loading:E(F.a.getList),onClick:Object(o.a)(i.a.mark(function e(){var t,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.getAddProductList({is_group:~~(null===(t=n.params)||void 0===t?void 0:t.is_group)});case 2:(null===(a=e.sent)||void 0===a?void 0:a.length)&&k.openEditClick({data:{waitList:a.map(function(e){return Object(r.a)({},e,{lastOutAmount:e.price_out})})}});case 4:case"end":return e.stop()}},e)}))},"\u751f\u6210\u8865\u8d27\u5355")))),l.a.createElement("main",null,j?l.a.createElement(s.Loading,null,l.a.createElement(f.a,null)):l.a.createElement(p.a.Table,{theme:a},l.a.createElement(_.a,null,l.a.createElement(v.a,null,["\u8865\u8d27\u5355\u7f16\u53f7","\u521b\u5efa\u65f6\u95f4","\u8865\u8d27\u5355\u72b6\u6001","\u8ba2\u5355\u8be6\u60c5"].map(function(e){return l.a.createElement(g.a,{key:"TableHead".concat(e)},e)}))),l.a.createElement(h.a,null,null===w||void 0===w?void 0:w.map(function(e){return l.a.createElement(v.a,{key:"TableBody".concat(null===e||void 0===e?void 0:e.id)},l.a.createElement(g.a,null,null===e||void 0===e?void 0:e.number),l.a.createElement(g.a,null,Object(y.e)(new Date(null===e||void 0===e?void 0:e.create_time),"yyyy/MM/dd HH:mm")),l.a.createElement(g.a,null,D.e[null===e||void 0===e?void 0:e.state]),l.a.createElement(g.a,null,l.a.createElement(p.a.ActionTableCell,null,l.a.createElement(H.a,{color:"secondary",onClick:function(){k.openEditClick({data:Object(r.a)({},e,{waitList:null===e||void 0===e?void 0:e.addItemList.map(R)})})},variant:"contained"},"\u7f16\u8f91"),(null===e||void 0===e?void 0:e.state)===D.d.Pending&&l.a.createElement(H.a,{color:"secondary",onClick:function(){},variant:"contained"},"\u5220\u9664"))))}))),l.a.createElement(m.b,{pageModel:c})),l.a.createElement(M,{isGroup:~~(null===(t=n.params)||void 0===t?void 0:t.is_group)}))};t.default=W},398:function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"b",function(){return c});var a=n(21),i=n(18);function r(){var e=Object(a.a)(["\n    mutation ($data: ProductInput) {\n        save_product(ProductInput: $data) {\n            msg\n            flag\n            product {\n                id\n            }\n        }\n    }\n"]);return r=function(){return e},e}function o(){var e=Object(a.a)(["\n    query ($id: String) {\n        category_origin(id: $id) {\n            id number c2_id c2_name c3_id c3_name\n            c2_number c3_number\n        }\n    }\n"]);return o=function(){return e},e}function u(){var e=Object(a.a)(["\n    query ($data: ProductInput) {\n        product_list(ListInput: $data) {\n            id name number is_hot is_new stock price_in is_enable\n            price_market price_out weight unit brand category_id\n            c1_id c1_number c2_id c2_name c3_id c3_name\n            c2_number c3_number is_group group_amount group_precision\n            group_remark shelvesTypes packingUnit groupAmountUnit\n            imgs { id url number }\n        }\n        product_total(ListInput: $data)\n    }\n  "]);return u=function(){return e},e}var l={getList:Object(i.b)(u())},c=(Object(i.b)(o()),Object(i.b)(r()))},433:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(16),i=n(322),r=n(313),o={};o.Content=Object(a.a)(i.a).withConfig({displayName:"style__Content",componentId:"icrqdu-0"})(["&&&{> footer{margin:10px 0;display:flex;> button:not(:first-of-type){margin-left:10px;}}}"]),o.TextFieldBox=Object(a.a)(r.a).withConfig({displayName:"style__TextFieldBox",componentId:"icrqdu-1"})(["&&&{padding:0 15px;}"])}}]);