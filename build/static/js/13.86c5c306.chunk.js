(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{351:function(e,t,n){"use strict";n.r(t);var a=n(12),i=n.n(a),r=n(13),l=n(17),u=n(0),c=n.n(u),o=n(16),d=n(200),s={};s.Box=Object(o.a)("div").withConfig({displayName:"style__Box",componentId:"sc-1ay69up-0"})(["margin:20px;> header{display:grid;grid-column-gap:10px;grid-template-columns:minmax(200px,auto) repeat(2,1fr);> section{flex:1;}}"]),s.Table=Object(o.a)(d.a).withConfig({displayName:"style__Table",componentId:"sc-1ay69up-1"})(["&&&{margin-top:20px;border-radius:5px;border-collapse:initial;overflow:hidden;border:1px solid rgba(224,224,224,1);> thead{background:",";> tr > th{color:",";}}}"],function(e){return e.theme.palette.grey[800]},function(e){return e.theme.palette.common.white}),s.Loading=Object(o.a)("section").withConfig({displayName:"style__Loading",componentId:"sc-1ay69up-2"})(["text-align:center;"]),s.ActionTableCell=Object(o.a)("section").withConfig({displayName:"style__ActionTableCell",componentId:"sc-1ay69up-3"})(["&&&{display:flex;> button{margin-right:8px;&:last-of-type{margin-right:0;}}}"]),s.HeaderBox=Object(o.a)("section").withConfig({displayName:"style__HeaderBox",componentId:"sc-1ay69up-4"})(["&&&{display:flex;flex-direction:column;> header{font-size:20px;font-weight:bold;margin-bottom:15px;}> section{font-weight:bold;font-size:14px;margin-bottom:10px;}> main{display:flex;align-items:center;> div{margin-right:10px;}}}"]),s.ImgPreview=Object(o.a)("section").withConfig({displayName:"style__ImgPreview",componentId:"sc-1ay69up-5"})(["width:180px;display:inline-flex;> img{width:80px;height:60px;}> section{display:flex;flex-direction:column;justify-content:center;align-items:center;margin-left:10px;}"]),s.SearchBox=Object(o.a)("div").withConfig({displayName:"style__SearchBox",componentId:"sc-1ay69up-6"})(["display:grid;grid-template-columns:4fr 3fr 2fr;grid-gap:12px;> span{grid-area:2 / 1 / 2 / 3;justify-self:end;align-self:center;}"]);var p=n(101),m=n(78),f=n(381),b=n(60),v=n(385),g=n(41),_=n(384),h=n(386),y=n(18),x=n(73),O=n(55),E=n(39);function j(){var e=Object(O.a)(["\n    query ($data: ProductSupplementListInput) {\n        product_supplement_list_total(productSupplementListInput: $data)\n        product_supplement_list(productSupplementListInput: $data) {\n            id\n            name\n            amount\n            number\n            user_id\n            state\n            create_time\n            addItemList {\n                id\n                name\n                count\n                amount\n                supplier\n                lastOutAmount\n                product {\n                    id\n                    number\n                    is_group\n                    name\n                    stock\n                    price_in\n                    price_out\n                    price_market\n                    weight\n                }\n            }\n        }\n    }\n"]);return j=function(){return e},e}function w(){var e=Object(O.a)(["\n    mutation ($data: ProductInput) {\n        save_product(ProductInput: $data) {\n            msg\n            flag\n            product {\n                id\n            }\n        }\n    }\n"]);return w=function(){return e},e}function k(){var e=Object(O.a)(["\n    query ($id: String) {\n        category_origin(id: $id) {\n            id number c2_id c2_name c3_id c3_name\n            c2_number c3_number\n        }\n    }\n"]);return k=function(){return e},e}function L(){var e=Object(O.a)(["\n      mutation($data: ProductSupplementInput) {\n          save_product_supplement (productSupplementInput: $data) {\n              msg\n              flag\n          }\n      }\n  "]);return L=function(){return e},e}var C={save_product_supplement:Object(E.b)(L())},I=(Object(E.b)(k()),Object(E.b)(w()),Object(E.b)(j())),P=n(29),S=n(398),F=Object(m.c)("AddProductList",{listData:[]},{getList:function(){var e=Object(l.a)(i.a.mark(function e(t,n){var a,r,l,u,c,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.setData,r=n.query,l=n.data,e.next=3,r(I,Object(m.e)(l));case 3:u=e.sent,c=u.product_supplement_list,o=u.product_supplement_list_total,a(Object(y.g)({total:o,listData:c}));case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),getAddProductList:function(){var e=Object(l.a)(i.a.mark(function e(t,n){var a,r,l,u;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.query,e.next=3,r(S.a.getList);case 3:if(l=e.sent,null===(u=null===l||void 0===l?void 0:null===(a=l.product_list)||void 0===a?void 0:a.filter(function(e){return e.stock<0}))||void 0===u?void 0:u.length){e.next=8;break}return Object(P.b)({message:"\u6682\u65e0\u9700\u8981\u8865\u8d27\u7684\u5546\u54c1"}),e.abrupt("return");case 8:return e.abrupt("return",u);case 9:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}),T=n(25),B=n(152),$=n(49),D=n(100),N=Object(T.b)(Object(B.a)("wait",{id:"",waitList:[],state:1}),"waitListModal",{refreshData:function(){}},{setRefreshCall:function(e,t){return(0,t.setData)(Object(y.g)({refreshData:e}))},addOneProductSupplement:function(){var e=Object(l.a)(i.a.mark(function e(t,n){var a,l,u,c,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=n.data,c=n.mutate,e.next=3,c(C.save_product_supplement,{addList:u.modalData.waitList.map(function(e){return Object(r.a)({},Object($.pick)(e,["addRemark","addNumber","addPrice","addSupplier"]),u.modalData.id?{id:e.id,product_id:e.product_id}:{product_id:e.id})}),id:u.modalData.id,state:null!==(a=t.state)&&void 0!==a?a:1});case 3:return o=e.sent,(null===(l=o.save_product_supplement)||void 0===l?void 0:l.flag)&&(Object(P.b)({message:"\u64cd\u4f5c\u6210\u529f"}),u.refreshData()),e.abrupt("return",o);case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),isFinish:function(e,t){return t.data.modalData.state===D.ProductSupplement.Finish}}),A=n(328),q=n(427),H=n(322),R=n(37),M=function(e){var t;return Object(r.a)({},e.product,{lastOutAmount:e.lastOutAmount,addNumber:e.count,addPrice:e.amount,addSupplier:e.supplier,addRemark:e.remark,id:e.id,product_id:null===(t=e.product)||void 0===t?void 0:t.id})},W=function(){var e,t=Object(b.a)(),n=Object(x.a)(N),a=n.state,u=n.actions,o=u.setModal,d=a.modalData,s=a.fetchLoad[C.save_product_supplement],m=function(){var e=Object(l.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.addOneProductSupplement(t);case 2:if(!e.sent){e.next=4;break}u.onClose({});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return c.a.createElement(A.a,{fullWidth:!0,maxWidth:"lg",open:a.open,onClose:function(){return u.onClose({})}},c.a.createElement(H.a,null,"\u8865\u8d27\u5217\u8868"),c.a.createElement(q.a.Content,null,c.a.createElement(p.a.Table,{theme:t},c.a.createElement(_.a,null,c.a.createElement(v.a,null,["\u5546\u54c1\u7f16\u53f7","\u662f\u5426\u62fc\u56e2","\u4e2d\u6587\u540d\u79f0","\u5e93\u5b58","\u5e02\u573a\u4ef7\u683c","\u552e\u5356\u4ef7\u683c","\u8ba2\u5355\u9500\u552e\u4ef7\u683c"].map(function(e){return c.a.createElement(g.a,{key:"TableHead".concat(e)},e)}),c.a.createElement(g.a,{width:80},"\u8865\u8d27\u6570\u91cf"),c.a.createElement(g.a,{width:80},"\u8865\u8d27\u4ef7\u683c"),c.a.createElement(g.a,{width:100},"\u4f9b\u5e94\u5546"),c.a.createElement(g.a,{width:100},"\u5907\u6ce8"))),c.a.createElement(h.a,null,null===d||void 0===d?void 0:null===(e=d.waitList)||void 0===e?void 0:e.map(function(e,t){var n,a,i,l;return c.a.createElement(v.a,{key:"TableBody".concat(null===e||void 0===e?void 0:e.id)},c.a.createElement(g.a,null,null===e||void 0===e?void 0:e.number),c.a.createElement(g.a,null,(null===e||void 0===e?void 0:e.is_group)?"\u662f":"\u5426"),c.a.createElement(g.a,null,null===e||void 0===e?void 0:e.name),c.a.createElement(g.a,null,null===e||void 0===e?void 0:e.stock),c.a.createElement(g.a,null,null===e||void 0===e?void 0:e.price_market),c.a.createElement(g.a,null,null===e||void 0===e?void 0:e.price_out),c.a.createElement(g.a,null,null===e||void 0===e?void 0:e.lastOutAmount),c.a.createElement(g.a,null,c.a.createElement(q.a.TextFieldBox,{label:"",type:"number",disabled:u.isFinish(),value:null!==(n=null===e||void 0===e?void 0:e.addNumber)&&void 0!==n?n:"",onChange:function(e){return o(Object(r.a)({},d,{waitList:d.waitList.map(function(n,a){return a!==t?n:Object(r.a)({},n,{addNumber:parseFloat(e.target.value)})})}))}})),c.a.createElement(g.a,null,c.a.createElement(q.a.TextFieldBox,{disabled:u.isFinish(),label:"",type:"number",value:null!==(a=null===e||void 0===e?void 0:e.addPrice)&&void 0!==a?a:"",onChange:function(e){return o(Object(r.a)({},d,{waitList:d.waitList.map(function(n,a){return a!==t?n:Object(r.a)({},n,{addPrice:parseFloat(e.target.value)})})}))}})),c.a.createElement(g.a,null,c.a.createElement(q.a.TextFieldBox,{disabled:u.isFinish(),label:"",value:null!==(i=null===e||void 0===e?void 0:e.addSupplier)&&void 0!==i?i:"",onChange:function(e){return o(Object(r.a)({},d,{waitList:d.waitList.map(function(n,a){return a!==t?n:Object(r.a)({},n,{addSupplier:e.target.value})})}))}})),c.a.createElement(g.a,null,c.a.createElement(q.a.TextFieldBox,{disabled:u.isFinish(),label:"",value:null!==(l=null===e||void 0===e?void 0:e.addRemark)&&void 0!==l?l:"",onChange:function(e){return o(Object(r.a)({},d,{waitList:d.waitList.map(function(n,a){return a!==t?n:Object(r.a)({},n,{addRemark:e.target.value})})}))}})))}))),c.a.createElement("footer",null,d.id?c.a.createElement(c.a.Fragment,null,c.a.createElement(R.a,{loading:s?1:0,disabled:u.isFinish(),color:"primary",variant:"contained",fullWidth:!0,onClick:function(){return m({})}},"\u66f4\u65b0\u6570\u91cf"),c.a.createElement(R.a,{loading:s?1:0,color:"primary",variant:"contained",fullWidth:!0,onClick:function(){return m({state:u.isFinish()?1:2})}},u.isFinish()?"\u64a4\u9500\u8865\u8d27":"\u786e\u5b9a\u8865\u8d27\u5b8c\u6210")):c.a.createElement(R.a,{loading:s?1:0,color:"primary",variant:"contained",fullWidth:!0,onClick:function(){return m({})}},"\u4fdd\u5b58"))))};n.d(t,"AddProduct",function(){return z});var z=function(){var e=Object(b.a)(),t=Object(x.a)(F),n=t.state,a=t.actions,o=t.getLoad,d=o(I),O=n.listData,E=Object(x.a)(N).actions;return Object(u.useEffect)(function(){E.setRefreshCall(a.getList)},[a.getList,E]),Object(u.useEffect)(function(){a.getList({})},[a]),c.a.createElement(p.a.Box,null,c.a.createElement("header",null,c.a.createElement(p.a.HeaderBox,null,c.a.createElement("header",null,"\u8865\u8d27\u5217\u8868"),c.a.createElement("section",null,"\u60a8\u53ef\u4ee5\u8fdb\u884c\u7ba1\u7406"),c.a.createElement("main",null,c.a.createElement(R.a,{variant:"contained",color:"primary",loading:o(S.a.getList),onClick:Object(l.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getAddProductList({});case 2:t=e.sent,E.openEditClick({data:{waitList:t.map(function(e){return Object(r.a)({},e,{lastOutAmount:e.price_out})})}});case 4:case"end":return e.stop()}},e)}))},"\u751f\u6210\u8865\u8d27\u5355")))),c.a.createElement("main",null,d?c.a.createElement(s.Loading,null,c.a.createElement(f.a,null)):c.a.createElement(p.a.Table,{theme:e},c.a.createElement(_.a,null,c.a.createElement(v.a,null,["\u8865\u8d27\u5355\u7f16\u53f7","\u521b\u5efa\u65f6\u95f4","\u8865\u8d27\u5355\u72b6\u6001","\u8ba2\u5355\u8be6\u60c5"].map(function(e){return c.a.createElement(g.a,{key:"TableHead".concat(e)},e)}))),c.a.createElement(h.a,null,null===O||void 0===O?void 0:O.map(function(e){return c.a.createElement(v.a,{key:"TableBody".concat(null===e||void 0===e?void 0:e.id)},c.a.createElement(g.a,null,null===e||void 0===e?void 0:e.number),c.a.createElement(g.a,null,Object(y.e)(new Date(null===e||void 0===e?void 0:e.create_time),"yyyy/MM/dd HH:mm")),c.a.createElement(g.a,null,D.ProductSupplementString[null===e||void 0===e?void 0:e.state]),c.a.createElement(g.a,null,c.a.createElement(p.a.ActionTableCell,null,c.a.createElement(R.a,{color:"secondary",onClick:function(){E.openEditClick({data:Object(r.a)({},e,{waitList:null===e||void 0===e?void 0:e.addItemList.map(M)})})},variant:"contained"},"\u7f16\u8f91"),(null===e||void 0===e?void 0:e.state)===D.ProductSupplement.Pending&&c.a.createElement(R.a,{color:"secondary",onClick:function(){},variant:"contained"},"\u5220\u9664"))))}))),c.a.createElement(m.b,{pageModel:t})),c.a.createElement(W,null))};t.default=z},398:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return o});var a=n(55),i=n(39);function r(){var e=Object(a.a)(["\n    mutation ($data: ProductInput) {\n        save_product(ProductInput: $data) {\n            msg\n            flag\n            product {\n                id\n            }\n        }\n    }\n"]);return r=function(){return e},e}function l(){var e=Object(a.a)(["\n    query ($id: String) {\n        category_origin(id: $id) {\n            id number c2_id c2_name c3_id c3_name\n            c2_number c3_number\n        }\n    }\n"]);return l=function(){return e},e}function u(){var e=Object(a.a)(["\n    query ($data: ProductInput) {\n        product_list(ListInput: $data) {\n            id name number is_hot is_new stock price_in is_enable\n            price_market price_out weight unit brand category_id\n            c1_id c1_number c2_id c2_name c3_id c3_name\n            c2_number c3_number is_group group_amount group_precision\n            group_remark shelvesTypes packingUnit\n            imgs { id url number }\n        }\n        product_total(ListInput: $data)\n    }\n  "]);return u=function(){return e},e}var c={getList:Object(i.b)(u())},o=(Object(i.b)(l()),Object(i.b)(r()))},427:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n(16),i=n(323),r=n(314),l={};l.Content=Object(a.a)(i.a).withConfig({displayName:"style__Content",componentId:"icrqdu-0"})(["&&&{> footer{margin:10px 0;display:flex;> button:not(:first-of-type){margin-left:10px;}}}"]),l.TextFieldBox=Object(a.a)(r.a).withConfig({displayName:"style__TextFieldBox",componentId:"icrqdu-1"})(["&&&{padding:0 15px;}"])}}]);