{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport AddIcon from '@material-ui/icons/Add';\nimport RemoveIcon from '@material-ui/icons/Remove';\nimport styled from 'styled-components';\nimport { dealImgUrl } from '../../tools/img';\nimport { grey } from '@material-ui/core/colors';\nimport { productModel, ProductPrice } from '../../components/ProductItem/ProductItem';\nimport { Button, IconButton } from '@material-ui/core';\nimport { useStoreModel } from '../../ModelAction/useStore';\nimport { ls } from '../../tools/dealKey';\nimport { shopCartModel } from './index';\nimport { showMessage } from '../../components/Message/Message';\nimport { updateShopCartModel } from '../../components/ProductItem/UpdateShopCart';\nexport var ShopCartProductBox = styled.div.withConfig({\n  displayName: \"CartProduct__ShopCartProductBox\",\n  componentId: \"sc-1cjcsc1-0\"\n})([\"margin-bottom:16px;display:grid;grid-template-columns:minmax(20px,72px) 1fr;grid-template-rows:repeat(2,22px) 30px;grid-column-gap:10px;> img{grid-area:1/1/4/2;width:100%;height:100%;border-radius:8px;}> section{color:\", \"}> footer{display:flex;align-items:center;> main{flex-grow:1;}> button{flex-shrink:0;font-size:12px;}}\"], grey[600]);\nexport var CartProduct = function CartProduct(_ref) {\n  var _shopCart$product, _shopCart$product$img, _shopCart$product$img2, _shopCart$number;\n\n  var shopCart = _ref.shopCart;\n\n  var _useStoreModel = useStoreModel(shopCartModel),\n      actionsSCM = _useStoreModel.actions,\n      stateSCM = _useStoreModel.state;\n\n  var _useStoreModel2 = useStoreModel(productModel),\n      actionsPM = _useStoreModel2.actions;\n\n  var _useStoreModel3 = useStoreModel(updateShopCartModel),\n      actionsUpdateShopCartModel = _useStoreModel3.actions;\n\n  var product = shopCart.product;\n  return __jsx(ShopCartProductBox, null, __jsx(\"img\", {\n    src: dealImgUrl((_shopCart$product = shopCart.product) === null || _shopCart$product === void 0 ? void 0 : (_shopCart$product$img = _shopCart$product.img) === null || _shopCart$product$img === void 0 ? void 0 : (_shopCart$product$img2 = _shopCart$product$img[0]) === null || _shopCart$product$img2 === void 0 ? void 0 : _shopCart$product$img2.url),\n    alt: \"\"\n  }), __jsx(\"main\", null, product === null || product === void 0 ? void 0 : product.name, product === null || product === void 0 ? void 0 : product.weight, product === null || product === void 0 ? void 0 : product.unit), __jsx(\"section\", null, product === null || product === void 0 ? void 0 : product.remark), __jsx(\"footer\", null, __jsx(ProductPrice, {\n    product: product\n  }), shopCart.isNext === 0 && __jsx(React.Fragment, null, __jsx(Button, {\n    size: 'small',\n    variant: 'outlined',\n    onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return actionsPM.updateShopCart({\n                isNext: 1,\n                id: shopCart.id\n              });\n\n            case 2:\n              actionsSCM.getList();\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))\n  }, ls('下次购买')), __jsx(IconButton, {\n    disabled: ((_shopCart$number = shopCart === null || shopCart === void 0 ? void 0 : shopCart.number) !== null && _shopCart$number !== void 0 ? _shopCart$number : 0) <= 1,\n    size: 'small',\n    onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return actionsPM.updateNumShopCart({\n                product: product,\n                number: -1\n              });\n\n            case 2:\n              actionsSCM.getList();\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }))\n  }, __jsx(RemoveIcon, null)), shopCart.number, __jsx(IconButton, {\n    size: 'small',\n    onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return actionsPM.updateNumShopCart({\n                product: product\n              });\n\n            case 2:\n              actionsSCM.getList();\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }))\n  }, __jsx(AddIcon, null))) || __jsx(React.Fragment, null, __jsx(Button, {\n    style: {\n      marginRight: '8px'\n    },\n    size: 'small',\n    variant: 'outlined',\n    color: 'secondary',\n    onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return actionsPM.updateShopCart({\n                isDelete: 1,\n                id: shopCart.id\n              });\n\n            case 2:\n              actionsSCM.getList();\n\n            case 3:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }))\n  }, ls('删除')), __jsx(Button, {\n    size: 'small',\n    variant: 'outlined' // onClick={async () => {\n    //   if (stateSCM.shopCartList.findIndex(v => v.product?.id === shopCart.product?.id) > -1) {\n    //     return showMessage('该商品已在购物车中')\n    //   }\n    //   await actionsPM.updateShopCart({\n    //     isNext: 0,\n    //     id: shopCart.id,\n    //   })\n    //   actionsSCM.getList()\n    // }}\n    ,\n    onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      var res, _yield$actionsPM$upda, _yield$actionsPM$upda2;\n\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return actionsUpdateShopCartModel.openClick();\n\n            case 2:\n              res = _context5.sent;\n\n              if (!((res === null || res === void 0 ? void 0 : res.num) > 0)) {\n                _context5.next = 18;\n                break;\n              }\n\n              _context5.next = 6;\n              return actionsPM.updateNumShopCart({\n                product: product,\n                number: ~~(res === null || res === void 0 ? void 0 : res.num)\n              });\n\n            case 6:\n              _context5.t1 = _yield$actionsPM$upda = _context5.sent;\n              _context5.t0 = _context5.t1 === null;\n\n              if (_context5.t0) {\n                _context5.next = 10;\n                break;\n              }\n\n              _context5.t0 = _yield$actionsPM$upda === void 0;\n\n            case 10:\n              if (!_context5.t0) {\n                _context5.next = 14;\n                break;\n              }\n\n              _context5.t2 = void 0;\n              _context5.next = 15;\n              break;\n\n            case 14:\n              _context5.t2 = (_yield$actionsPM$upda2 = _yield$actionsPM$upda.updateNumShopCart) === null || _yield$actionsPM$upda2 === void 0 ? void 0 : _yield$actionsPM$upda2.id;\n\n            case 15:\n              if (!_context5.t2) {\n                _context5.next = 18;\n                break;\n              }\n\n              showMessage('操作成功');\n              actionsSCM.getList();\n\n            case 18:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }))\n  }, ls('加入购物车')))));\n};","map":null,"metadata":{},"sourceType":"module"}