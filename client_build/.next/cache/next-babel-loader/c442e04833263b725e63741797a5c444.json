{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport { modelFactory } from '../../ModelAction/modelUtil';\nimport { doc } from '../../graphqlTypes/doc';\nimport { dealMaybeNumber, dealMoney, fpMergePre } from '../../tools/utils';\nimport { useStoreModel } from '../../ModelAction/useStore';\nimport { ls } from '../../tools/dealKey';\nimport { HeaderTitle } from '../../components/HeaderTitle/HeaderTitle';\nimport { LinearProgress, MenuItem, TextField } from '@material-ui/core';\nimport { grey } from '@material-ui/core/colors';\nimport styled from 'styled-components';\nimport { getPickUpTypeName, PickUpTypeEnum } from '../../ss_common/enum';\nimport { CartProduct } from './CartProduct';\nimport { setForm } from '../../tools/commonAction';\nexport var shopCartModel = modelFactory('shopCartModel', {\n  shopCartList: [],\n  form: {\n    pickUpType: PickUpTypeEnum.Self\n  }\n}, {\n  clearForm: function clearForm(value, option) {\n    return option.setData(fpMergePre({\n      form: {\n        pickUpType: PickUpTypeEnum.Self\n      }\n    }));\n  },\n  setForm: setForm,\n  getList: function () {\n    var _getList = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value, option) {\n      var _res$shopCartList;\n\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return option.query(doc.userShopCartList);\n\n            case 2:\n              res = _context.sent;\n              option.setData(fpMergePre({\n                shopCartList: (_res$shopCartList = res === null || res === void 0 ? void 0 : res.shopCartList) !== null && _res$shopCartList !== void 0 ? _res$shopCartList : []\n              }));\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function getList(_x, _x2) {\n      return _getList.apply(this, arguments);\n    }\n\n    return getList;\n  }()\n});\nvar Box = styled.section.withConfig({\n  displayName: \"cart__Box\",\n  componentId: \"sc-6jpkeq-0\"\n})([\"padding:0 20px;\"]);\nexport var ShopCartPage = function ShopCartPage() {\n  var _useStoreModel = useStoreModel(shopCartModel),\n      stateSCM = _useStoreModel.state,\n      actionsSCM = _useStoreModel.actions,\n      getLoad = _useStoreModel.getLoad;\n\n  useEffect(function () {\n    actionsSCM.getList();\n  }, []);\n  console.log(stateSCM.shopCartList);\n  var productNumber = stateSCM.shopCartList.reduce(function (pre, cur) {\n    var _cur$number;\n\n    return pre + ((_cur$number = cur === null || cur === void 0 ? void 0 : cur.number) !== null && _cur$number !== void 0 ? _cur$number : 0);\n  }, 0);\n  var productSubtotal = dealMoney(stateSCM.shopCartList.reduce(function (pre, cur) {\n    var _cur$product;\n\n    return pre + dealMaybeNumber(cur === null || cur === void 0 ? void 0 : cur.number) * dealMaybeNumber(cur === null || cur === void 0 ? void 0 : (_cur$product = cur.product) === null || _cur$product === void 0 ? void 0 : _cur$product.priceOut);\n  }, 0));\n  return __jsx(\"div\", null, __jsx(HeaderTitle, {\n    title: '购物车'\n  }), !!getLoad(doc.userShopCartList) && __jsx(LinearProgress, null) || __jsx(\"div\", {\n    style: {\n      height: '4px'\n    }\n  }), __jsx(Box, null, __jsx(\"div\", {\n    style: {\n      fontSize: '18px',\n      textAlign: 'center'\n    }\n  }, productNumber, ls('件商品')), __jsx(\"div\", {\n    style: {\n      fontSize: '14px',\n      textAlign: 'center',\n      color: grey[600],\n      marginTop: '8px',\n      marginBottom: '10px'\n    }\n  }, ls('小计'), \":\", productSubtotal), stateSCM.shopCartList.map(function (value) {\n    return __jsx(CartProduct, {\n      key: \"CartProduct_\".concat(value.id),\n      shopCart: value\n    });\n  }), __jsx(TextField, {\n    style: {\n      marginTop: '10px'\n    },\n    fullWidth: true,\n    label: ls('运送方式'),\n    select: true,\n    value: stateSCM.form.pickUpType,\n    onChange: function onChange(event) {\n      return actionsSCM.setForm(['pickUpType', event.target.value]);\n    }\n  }, __jsx(MenuItem, {\n    value: PickUpTypeEnum.Self\n  }, ls(getPickUpTypeName(PickUpTypeEnum.Self))), __jsx(MenuItem, {\n    value: PickUpTypeEnum.Delivery\n  }, ls(getPickUpTypeName(PickUpTypeEnum.Delivery))))));\n};","map":null,"metadata":{},"sourceType":"module"}