{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport Router, { useRouter } from 'next/router';\nimport { useStoreModel } from '../../ModelAction/useStore';\nimport { KeyboardArrowRight } from '@material-ui/icons';\nimport { ButtonBase, LinearProgress } from '@material-ui/core';\nimport { fpMergePre } from '../../tools/utils';\nimport { HeaderTitle } from '../../components/HeaderTitle/HeaderTitle';\nimport { doc } from '../../graphqlTypes/doc';\nimport { BScroller } from '../../components/BScroll/BScroller';\nimport { modelFactory } from '../../ModelAction/modelUtil';\nimport styled from 'styled-components';\nimport { grey } from '@material-ui/core/colors';\nimport { dealImgUrl } from '../../tools/img';\nimport { ProductItem } from '../../components/ProductItem/ProductItem';\nimport { ls } from '../../tools/dealKey';\nimport { NoData } from '../../components/NoData/NoData';\nexport var CategoryPageModel = modelFactory('CategoryPage', {\n  productList: [],\n  categoryList: []\n}, {\n  getProductList: function () {\n    var _getProductList = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value, option) {\n      var _res$productsInCatego, _res$categoryList$lis, _res$categoryList;\n\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return option.query(doc.productsInCategory, {\n                data: value\n              });\n\n            case 2:\n              res = _context.sent;\n              option.setData(fpMergePre({\n                productList: (_res$productsInCatego = res === null || res === void 0 ? void 0 : res.productsInCategory) !== null && _res$productsInCatego !== void 0 ? _res$productsInCatego : [],\n                categoryList: _toConsumableArray((_res$categoryList$lis = res === null || res === void 0 ? void 0 : (_res$categoryList = res.categoryList) === null || _res$categoryList === void 0 ? void 0 : _res$categoryList.list) !== null && _res$categoryList$lis !== void 0 ? _res$categoryList$lis : [])\n              }));\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function getProductList(_x, _x2) {\n      return _getProductList.apply(this, arguments);\n    }\n\n    return getProductList;\n  }()\n});\nvar Box = styled('div').withConfig({\n  displayName: \"id__Box\",\n  componentId: \"sc-13c54cm-0\"\n})([\"padding:0 20px;> header{font-size:18px;font-weight:bold;margin:10px 0;}\"]);\nvar CategoryItemStyle = styled(ButtonBase).withConfig({\n  displayName: \"id__CategoryItemStyle\",\n  componentId: \"sc-13c54cm-1\"\n})([\"&&&{width:100%;height:60px;display:flex;border-radius:8px;overflow:hidden;margin-bottom:10px;background:\", \";> img{height:100%;width:70%;}> span{flex:1;color:#fff;display:flex;align-items:center;justify-content:center;}}\"], grey[700]);\nvar categoryItemModel = modelFactory('categoryItemModel', {\n  test: ''\n}, {\n  getLevel: function () {\n    var _getLevel = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(value, option) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return option.query(doc.categoryLevel, {\n                data: value\n              });\n\n            case 2:\n              return _context2.abrupt(\"return\", _context2.sent);\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    function getLevel(_x3, _x4) {\n      return _getLevel.apply(this, arguments);\n    }\n\n    return getLevel;\n  }()\n});\nvar ListBox = styled.div.withConfig({\n  displayName: \"id__ListBox\",\n  componentId: \"sc-13c54cm-2\"\n})([\"display:grid;grid-template-columns:repeat(2,1fr);grid-gap:15px;\"]);\nexport var CategoryPage = function CategoryPage() {\n  var _ref, _router$query;\n\n  var router = useRouter();\n  var id = (_ref = (_router$query = router.query) === null || _router$query === void 0 ? void 0 : _router$query.id) !== null && _ref !== void 0 ? _ref : '';\n\n  var _useStoreModel = useStoreModel(CategoryPageModel),\n      stateCPM = _useStoreModel.state,\n      actionsCPM = _useStoreModel.actions,\n      getLoad = _useStoreModel.getLoad;\n\n  var _useStoreModel2 = useStoreModel(categoryItemModel),\n      actionsCI = _useStoreModel2.actions;\n\n  var CategoryItem = function CategoryItem(v) {\n    return __jsx(CategoryItemStyle, {\n      key: \"CategoryItem_\".concat(v.id),\n      onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var _yield$actionsCI$getL;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return actionsCI.getLevel({\n                  id: v.id\n                });\n\n              case 2:\n                _context3.t1 = _yield$actionsCI$getL = _context3.sent;\n                _context3.t0 = _context3.t1 === null;\n\n                if (_context3.t0) {\n                  _context3.next = 6;\n                  break;\n                }\n\n                _context3.t0 = _yield$actionsCI$getL === void 0;\n\n              case 6:\n                if (!_context3.t0) {\n                  _context3.next = 10;\n                  break;\n                }\n\n                _context3.t2 = void 0;\n                _context3.next = 11;\n                break;\n\n              case 10:\n                _context3.t2 = _yield$actionsCI$getL.categoryLevel;\n\n              case 11:\n                _context3.t3 = _context3.t2;\n\n                if (!(_context3.t3 === 3)) {\n                  _context3.next = 17;\n                  break;\n                }\n\n                _context3.next = 15;\n                return Router.push('/productList/[id]', \"/productList/\".concat(v.id));\n\n              case 15:\n                _context3.next = 19;\n                break;\n\n              case 17:\n                _context3.next = 19;\n                return Router.push('/category/[id]', \"/category/\".concat(v.id));\n\n              case 19:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }))\n    }, __jsx(\"img\", {\n      src: dealImgUrl(v.imgUrl),\n      alt: \"\"\n    }), __jsx(\"span\", null, v.name, __jsx(KeyboardArrowRight, null)));\n  };\n\n  useEffect(function () {\n    if (id) {\n      actionsCPM.getProductList({\n        id: id\n      });\n    }\n  }, [id]);\n  return __jsx(\"div\", null, __jsx(HeaderTitle, {\n    title: ''\n  }), !!getLoad(doc.productsInCategory) && __jsx(LinearProgress, null), __jsx(BScroller, {\n    boxHeight: 'calc(100vh - 60px)'\n  }, __jsx(Box, null, stateCPM.categoryList.length === 0 && stateCPM.productList.length === 0 && __jsx(NoData, null) || __jsx(React.Fragment, null, stateCPM.categoryList.map(function (value) {\n    return CategoryItem(value);\n  }), __jsx(\"header\", null, ls('热门推荐')), stateCPM.productList.length === 0 && __jsx(NoData, null), __jsx(ListBox, null, stateCPM.productList.map(function (value) {\n    return __jsx(ProductItem, {\n      key: \"ProductItem_\".concat(value.id),\n      product: value\n    });\n  }))))));\n};","map":null,"metadata":{},"sourceType":"module"}