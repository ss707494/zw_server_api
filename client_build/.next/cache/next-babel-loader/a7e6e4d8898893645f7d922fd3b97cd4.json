{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport { HeaderTitle } from '../../../../components/HeaderTitle/HeaderTitle';\nimport { modelFactory } from '../../../../ModelAction/modelUtil';\nimport { doc } from '../../../../graphqlTypes/doc';\nimport { useStoreModel } from '../../../../ModelAction/useStore';\nimport { fpMergePre } from '../../../../tools/utils';\nimport styled from 'styled-components';\nimport { Button, ButtonBase, IconButton } from '@material-ui/core';\nimport { dealImgUrl } from '../../../../tools/img';\nimport { grey } from '@material-ui/core/colors';\nimport { ls } from '../../../../tools/dealKey';\nimport { showMessage } from '../../../../components/Message/Message';\nimport { DefaultBox } from '../myAddress/list';\nimport { PickupAddressDetail, PickupAddressDetailModel } from './pickupAddressDetail';\nimport InfoIcon from '@material-ui/icons/Info';\nvar pickupAddressModel = modelFactory('pickupAddressModel', {\n  list: [],\n  user: {}\n}, {\n  getList: function () {\n    var _getList = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value, option) {\n      var _res$getDataConfig$va, _res$getDataConfig, _res$getDataConfig$va2;\n\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return option.query(doc.pickupAddress, {});\n\n            case 2:\n              res = _context.sent;\n              option.setData(fpMergePre({\n                list: (_res$getDataConfig$va = res === null || res === void 0 ? void 0 : (_res$getDataConfig = res.getDataConfig) === null || _res$getDataConfig === void 0 ? void 0 : (_res$getDataConfig$va2 = _res$getDataConfig.value) === null || _res$getDataConfig$va2 === void 0 ? void 0 : _res$getDataConfig$va2.list) !== null && _res$getDataConfig$va !== void 0 ? _res$getDataConfig$va : [],\n                user: res === null || res === void 0 ? void 0 : res.oneUser\n              }));\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function getList(_x, _x2) {\n      return _getList.apply(this, arguments);\n    }\n\n    return getList;\n  }(),\n  setDefault: function () {\n    var _setDefault = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(value, option) {\n      var _option$data$user$use, _res$updateUserInfo;\n\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              res = option.mutate(doc.updateUserInfo, {\n                userInfo: {\n                  id: (_option$data$user$use = option.data.user.userInfo) === null || _option$data$user$use === void 0 ? void 0 : _option$data$user$use.id,\n                  pickupAddressId: value.id\n                }\n              });\n\n              if (res === null || res === void 0 ? void 0 : (_res$updateUserInfo = res.updateUserInfo) === null || _res$updateUserInfo === void 0 ? void 0 : _res$updateUserInfo.id) {\n                showMessage('操作成功');\n              }\n\n              return _context2.abrupt(\"return\", res);\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    function setDefault(_x3, _x4) {\n      return _setDefault.apply(this, arguments);\n    }\n\n    return setDefault;\n  }()\n});\nvar ItemBox = styled(ButtonBase).withConfig({\n  displayName: \"list__ItemBox\",\n  componentId: \"cem9up-0\"\n})([\"&&&{display:flex;padding:10px 20px;> img{width:18vw;height:18vw;}> section{margin-left:9px;text-align:left;> main,footer{font-size:12px;color:\", \";}}}\"], grey[600]);\nvar Box = styled.div.withConfig({\n  displayName: \"list__Box\",\n  componentId: \"cem9up-1\"\n})([\"display:grid;grid-template-columns:1fr 108px;align-items:center;justify-items:start;\"]);\nvar RightBox = styled.div.withConfig({\n  displayName: \"list__RightBox\",\n  componentId: \"cem9up-2\"\n})([\"display:flex;flex-direction:column;\"]);\nexport var PickupAddress = function PickupAddress() {\n  var _useStoreModel = useStoreModel(pickupAddressModel),\n      actionsPAM = _useStoreModel.actions,\n      statePAM = _useStoreModel.state;\n\n  var _useStoreModel2 = useStoreModel(PickupAddressDetailModel),\n      actionsPickupAddressDetailModel = _useStoreModel2.actions,\n      statePickupAddressDetailModel = _useStoreModel2.state;\n\n  useEffect(function () {\n    if (!statePAM.list.length) {\n      actionsPAM.getList();\n    }\n  }, []);\n  return __jsx(\"div\", null, __jsx(HeaderTitle, {\n    title: '我的取货点'\n  }), __jsx(Box, null, statePAM.list.map(function (value) {\n    var _statePAM$user$userIn;\n\n    return __jsx(React.Fragment, {\n      key: \"PickupAddress_\".concat(value.id)\n    }, __jsx(ItemBox, null, __jsx(\"img\", {\n      src: dealImgUrl(value.imgUrl),\n      alt: \"\"\n    }), __jsx(\"section\", null, __jsx(\"header\", null, value.fullName), __jsx(\"footer\", null, \"\".concat(value.streetAddress)), __jsx(\"main\", null, \"\".concat(value.city, \" \").concat(value.province, \" \").concat(value.zip)))), __jsx(RightBox, null, __jsx(IconButton, {\n      onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return actionsPickupAddressDetailModel.openClick(value);\n\n              case 2:\n                res = _context3.sent;\n                console.log(res);\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }))\n    }, __jsx(InfoIcon, null)), ((_statePAM$user$userIn = statePAM.user.userInfo) === null || _statePAM$user$userIn === void 0 ? void 0 : _statePAM$user$userIn.pickupAddressId) === value.id && __jsx(DefaultBox, null, ls('默认地址')) || __jsx(Button, {\n      color: 'secondary',\n      variant: 'outlined',\n      onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var _yield$actionsPAM$set, _yield$actionsPAM$set2;\n\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return actionsPAM.setDefault(value);\n\n              case 2:\n                _context4.t1 = _yield$actionsPAM$set = _context4.sent;\n                _context4.t0 = _context4.t1 === null;\n\n                if (_context4.t0) {\n                  _context4.next = 6;\n                  break;\n                }\n\n                _context4.t0 = _yield$actionsPAM$set === void 0;\n\n              case 6:\n                if (!_context4.t0) {\n                  _context4.next = 10;\n                  break;\n                }\n\n                _context4.t2 = void 0;\n                _context4.next = 11;\n                break;\n\n              case 10:\n                _context4.t2 = (_yield$actionsPAM$set2 = _yield$actionsPAM$set.updateUserInfo) === null || _yield$actionsPAM$set2 === void 0 ? void 0 : _yield$actionsPAM$set2.id;\n\n              case 11:\n                if (!_context4.t2) {\n                  _context4.next = 13;\n                  break;\n                }\n\n                actionsPAM.getList();\n\n              case 13:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }))\n    }, ls('设为默认'))));\n  })), __jsx(PickupAddressDetail, null));\n};","map":null,"metadata":{},"sourceType":"module"}