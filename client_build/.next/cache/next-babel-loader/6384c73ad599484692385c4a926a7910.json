{"ast":null,"code":"var __jsx = React.createElement;\nimport React from 'react';\nimport { mpStyle } from '../../../../style/common';\nimport styled from 'styled-components';\nimport { MeLayoutBox } from '../components/meLayoutBox';\nimport { Button, Divider } from '@material-ui/core';\nimport { Space } from '../../../../components/Box/Box';\nimport { ll } from '../../../../tools/dealKey';\nimport { BaseField } from '../components/BaseField';\nimport { modelFactory } from '../../../../ModelAction/modelUtil';\nimport { useStoreModel } from '../../../../ModelAction/useStore';\nimport { UpdateMyInfoModel, useUpdateMyInfoInit } from '../../../m/me/myInfo/updateMyInfo';\nimport { fpMergePre } from '../../../../tools/utils';\nimport { meModel } from '../../../m/me/model';\nimport { ButtonLoad } from '../../../../components/ButtonLoad/ButtonLoad';\nimport { doc } from '../../../../graphqlTypes/doc';\nimport { updatePasswordModel } from '../../../m/me/myInfo/updatePassword';\nconst TopTitle = styled('div').withConfig({\n  displayName: \"myInfo__TopTitle\",\n  componentId: \"y3lzcv-0\"\n})([\"\", \";display:grid;grid-template-columns:1fr max-content;&&&{.MuiButton-root{width:95px;height:27px;border-radius:19px;color:\", \";border:1px solid \", \";}}\"], mpStyle.fontType.l, mpStyle.red, mpStyle.red);\nconst FormBox = styled.div.withConfig({\n  displayName: \"myInfo__FormBox\",\n  componentId: \"y3lzcv-1\"\n})([\"display:grid;grid-template-columns:repeat(3,240px);grid-column-gap:60px;grid-row-gap:24px;\"]);\nconst SubmitButtons = styled.div.withConfig({\n  displayName: \"myInfo__SubmitButtons\",\n  componentId: \"y3lzcv-2\"\n})([\"&&&{.MuiButton-root{width:215px;height:50px;border-radius:8px;}}\"]);\nexport const PcMyInfoModel = modelFactory('PcMyInfoModel', {\n  isEditInfo: false,\n  isEditPass: false\n}, {\n  setEditInfo: async (value, option) => option.setData(fpMergePre({\n    isEditInfo: value\n  })),\n  setEditPass: async (value, option) => option.setData(fpMergePre({\n    isEditPass: value\n  }))\n});\nexport const PcMyInfo = () => {\n  const {\n    actions: actionsPcMyInfoModel,\n    state: statePcMyInfoModel\n  } = useStoreModel(PcMyInfoModel);\n  const {\n    actions: actionsUpdateMyInfoModel,\n    state: stateUpdateMyInfoModel,\n    getLoad\n  } = useStoreModel(UpdateMyInfoModel);\n  const {\n    state: stateUpdatePasswordModel,\n    actions: actionsUpdatePasswordModel\n  } = useStoreModel(updatePasswordModel);\n  const {\n    actions: actionsMe,\n    state: stateMeModel\n  } = useStoreModel(meModel);\n  const {\n    initForm\n  } = useUpdateMyInfoInit();\n  return __jsx(MeLayoutBox, null, __jsx(TopTitle, null, ll('个人资料'), !statePcMyInfoModel.isEditInfo && __jsx(Button, {\n    variant: 'outlined',\n    onClick: () => actionsPcMyInfoModel.setEditInfo(true)\n  }, ll('编辑'))), __jsx(Space, {\n    h: mpStyle.space.xs\n  }), __jsx(Divider, null), __jsx(Space, {\n    h: mpStyle.space.s\n  }), __jsx(FormBox, null, __jsx(BaseField, {\n    readonly: !statePcMyInfoModel.isEditInfo,\n    label: ll('姓名'),\n    value: stateUpdateMyInfoModel.form.name,\n    onChange: event => actionsUpdateMyInfoModel.setForm(['name', event.target.value])\n  }), __jsx(BaseField, {\n    readonly: !statePcMyInfoModel.isEditInfo,\n    label: ll('电话'),\n    value: stateUpdateMyInfoModel.form.phone,\n    onChange: event => actionsUpdateMyInfoModel.setForm(['phone', event.target.value])\n  }), __jsx(BaseField, {\n    readonly: !statePcMyInfoModel.isEditInfo,\n    label: ll('邮箱'),\n    value: stateUpdateMyInfoModel.form.email,\n    onChange: event => actionsUpdateMyInfoModel.setForm(['email', event.target.value])\n  }), __jsx(SubmitButtons, {\n    style: {\n      gridArea: '2/1/3/3',\n      alignSelf: 'start'\n    }\n  }, statePcMyInfoModel.isEditInfo && __jsx(React.Fragment, null, __jsx(ButtonLoad, {\n    variant: 'outlined',\n    loading: getLoad(doc.updateUserInfo),\n    onClick: () => {\n      actionsPcMyInfoModel.setEditInfo(false);\n      initForm();\n    }\n  }, ll('取消')), __jsx(Space, {\n    w: mpStyle.space.s\n  }), __jsx(ButtonLoad, {\n    variant: 'contained',\n    color: 'secondary',\n    loading: getLoad(doc.updateUserInfo),\n    onClick: async () => {\n      var _res$updateUserInfo;\n\n      const res = await actionsUpdateMyInfoModel.submit();\n\n      if (res === null || res === void 0 ? void 0 : (_res$updateUserInfo = res.updateUserInfo) === null || _res$updateUserInfo === void 0 ? void 0 : _res$updateUserInfo.id) {\n        actionsMe.getLoginUser();\n        actionsPcMyInfoModel.setEditInfo(false);\n      }\n    }\n  }, ll('保存'))))), __jsx(Space, {\n    h: mpStyle.space.s\n  }), __jsx(TopTitle, null, ll('账户资料'), !statePcMyInfoModel.isEditPass && __jsx(Button, {\n    variant: 'outlined',\n    onClick: () => actionsPcMyInfoModel.setEditPass(true)\n  }, ll('编辑'))), __jsx(Space, {\n    h: mpStyle.space.xs\n  }), __jsx(Divider, null), __jsx(Space, {\n    h: mpStyle.space.s\n  }), __jsx(FormBox, null, !statePcMyInfoModel.isEditPass && __jsx(React.Fragment, null, __jsx(BaseField, {\n    readonly: true,\n    label: ll('达人账号名'),\n    value: stateMeModel.user.name\n  }), __jsx(BaseField, {\n    readonly: true,\n    label: ll('密码'),\n    value: '*******'\n  }), __jsx(\"div\", null)) || __jsx(React.Fragment, null, __jsx(BaseField, {\n    readonly: true,\n    label: ll('达人账号名'),\n    value: stateMeModel.user.name\n  }), __jsx(\"div\", null), __jsx(\"div\", null), __jsx(BaseField, {\n    label: ll('原始密码'),\n    type: 'password',\n    value: stateUpdatePasswordModel.form.oldPassword,\n    onChange: event => actionsUpdatePasswordModel.setForm(['oldPassword', event.target.value])\n  }), __jsx(\"div\", null), __jsx(\"div\", null), __jsx(BaseField, {\n    label: ll('新密码'),\n    type: 'password',\n    value: stateUpdatePasswordModel.form.newPassword,\n    onChange: event => actionsUpdatePasswordModel.setForm(['newPassword', event.target.value])\n  }), __jsx(BaseField, {\n    label: ll('确认密码'),\n    type: 'password',\n    value: stateUpdatePasswordModel.form.confirmPassword,\n    onChange: event => actionsUpdatePasswordModel.setForm(['confirmPassword', event.target.value])\n  }), __jsx(\"div\", null), __jsx(SubmitButtons, {\n    style: {\n      gridArea: '4/1/5/3',\n      alignSelf: 'start'\n    }\n  }, __jsx(ButtonLoad, {\n    variant: 'outlined',\n    loading: getLoad(doc.updateUserInfo),\n    onClick: () => {\n      actionsPcMyInfoModel.setEditPass(false);\n      actionsUpdatePasswordModel.clearForm();\n    }\n  }, ll('取消')), __jsx(Space, {\n    w: mpStyle.space.s\n  }), __jsx(ButtonLoad, {\n    variant: 'contained',\n    color: 'secondary',\n    loading: getLoad(doc.updateUserInfo),\n    onClick: async () => {\n      var _res$updatePassword;\n\n      const res = await actionsUpdatePasswordModel.submit();\n\n      if (res === null || res === void 0 ? void 0 : (_res$updatePassword = res.updatePassword) === null || _res$updatePassword === void 0 ? void 0 : _res$updatePassword.id) {\n        actionsMe.getLoginUser();\n        actionsPcMyInfoModel.setEditPass(false);\n      }\n    }\n  }, ll('保存'))))));\n};","map":null,"metadata":{},"sourceType":"module"}