{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport { AppModuleTypeEnum, DictTypeEnum, RelatedObjTypeEnum } from '../../../ss_common/enum';\nimport { modelFactory } from '../../../ModelAction/modelUtil';\nimport { HomeTabs, homeTabsModel } from './components/Tabs/Tabs';\nimport CusCarousel from '../../../components/Swipe/Swipe';\nimport { HeaderSearch } from '../../../components/HeaderSearch/HeaderSearch';\nimport { FootBar } from '../../../components/FootBar/FootBar';\nimport { BScroller } from '../../../components/BScroll/BScroller';\nimport { grey } from '@material-ui/core/colors';\nimport { useStoreModel } from '../../../ModelAction/useStore';\nimport { getDataConfig, homeCarouselImgs } from '../../../graphqlTypes/doc';\nimport { formatDate, fpMergePre } from '../../../tools/utils';\nimport styled from 'styled-components';\nimport { dealImgUrl } from '../../../tools/img';\nexport var HomeType = {\n  home: 'home',\n  group: 'group'\n};\nexport var homeCarouselModel = modelFactory('homeCarouselModel', {\n  homeCarouselImgs: []\n}, {\n  getHomeCarousel: function () {\n    var _getHomeCarousel = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value, option) {\n      var res2, _res2$getDataConfig, __typename, rest, homeCarouselDataComfig;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return option.query(getDataConfig, {\n                data: {\n                  type: DictTypeEnum.HomeCarousel\n                }\n              }, {});\n\n            case 2:\n              res2 = _context.sent;\n              _res2$getDataConfig = res2 === null || res2 === void 0 ? void 0 : res2.getDataConfig, __typename = _res2$getDataConfig.__typename, rest = _objectWithoutProperties(_res2$getDataConfig, [\"__typename\"]);\n              _context.next = 6;\n              return option.query(homeCarouselImgs, {\n                data: _objectSpread({}, rest)\n              }, {});\n\n            case 6:\n              homeCarouselDataComfig = _context.sent;\n              option.setData(fpMergePre({\n                homeCarouselImgs: homeCarouselDataComfig === null || homeCarouselDataComfig === void 0 ? void 0 : homeCarouselDataComfig.homeCarouselImgs\n              }));\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function getHomeCarousel(_x, _x2) {\n      return _getHomeCarousel.apply(this, arguments);\n    }\n\n    return getHomeCarousel;\n  }()\n});\nvar CusSwipeImg = styled.div.withConfig({\n  displayName: \"appModule__CusSwipeImg\",\n  componentId: \"eet2po-0\"\n})([\"> aside{background:rgb(164,164,164,.4);color:white;position:absolute;top:4px;left:4px;padding:8px;border-radius:4px;font-size:small;display:flex;}\"]);\nexport var HomeAppModule = function HomeAppModule(type) {\n  return function () {\n    var _stateHomeCarouselMod, _stateHomeCarouselMod2;\n\n    var router = useRouter();\n    useEffect(function () {\n      if (router.query.appModule && ![AppModuleTypeEnum.limitTime, AppModuleTypeEnum.mayLike, AppModuleTypeEnum.salesRank, AppModuleTypeEnum.themeSelection, AppModuleTypeEnum.categorySelection, AppModuleTypeEnum.lineRanking, AppModuleTypeEnum.topRanking].includes(router.query.appModule)) {\n        router.replace('/home/[appModule]', '/home/categorySelection', {});\n      }\n    });\n\n    var _useStoreModel = useStoreModel(homeCarouselModel),\n        actionsHomeCarouselModel = _useStoreModel.actions,\n        stateHomeCarouselModel = _useStoreModel.state;\n\n    var _useStoreModel2 = useStoreModel(homeTabsModel),\n        actionsHomeTabs = _useStoreModel2.actions,\n        stateHomeTabsModel = _useStoreModel2.state;\n\n    useEffect(function () {\n      actionsHomeCarouselModel.getHomeCarousel();\n      actionsHomeTabs.getData();\n    }, []);\n    useEffect(function () {\n      actionsHomeTabs.setHomeType(type !== null && type !== void 0 ? type : HomeType.home);\n    }, [type]);\n    console.log((_stateHomeCarouselMod = stateHomeCarouselModel.homeCarouselImgs) === null || _stateHomeCarouselMod === void 0 ? void 0 : (_stateHomeCarouselMod2 = _stateHomeCarouselMod.value) === null || _stateHomeCarouselMod2 === void 0 ? void 0 : _stateHomeCarouselMod2.list);\n    return __jsx(\"div\", null, __jsx(HeaderSearch, {\n      homeType: type !== null && type !== void 0 ? type : HomeType.home\n    }), __jsx(BScroller, null, __jsx(\"div\", {\n      className: _JSXStyle.dynamic([[\"1873098083\", [grey[600]]]]) + \" \" + 'common_box'\n    }, __jsx(\"div\", {\n      className: _JSXStyle.dynamic([[\"1873098083\", [grey[600]]]]) + \" \" + 'cusCarousel'\n    }, function () {\n      var _stateHomeCarouselMod3, _stateHomeCarouselMod4, _stateHomeCarouselMod5, _stateHomeCarouselMod6;\n\n      var filterList = (_stateHomeCarouselMod3 = (_stateHomeCarouselMod4 = stateHomeCarouselModel.homeCarouselImgs) === null || _stateHomeCarouselMod4 === void 0 ? void 0 : (_stateHomeCarouselMod5 = _stateHomeCarouselMod4.value) === null || _stateHomeCarouselMod5 === void 0 ? void 0 : (_stateHomeCarouselMod6 = _stateHomeCarouselMod5.list) === null || _stateHomeCarouselMod6 === void 0 ? void 0 : _stateHomeCarouselMod6.filter(function (v) {\n        return !v.isDisabled;\n      })) !== null && _stateHomeCarouselMod3 !== void 0 ? _stateHomeCarouselMod3 : [];\n      return __jsx(CusCarousel, {\n        height: '160px',\n        dataList: filterList,\n        renderItem: function renderItem(item) {\n          var _item$objData, _item$objData2, _item$objData3, _item$objData4;\n\n          return __jsx(CusSwipeImg, {\n            key: \"Carousel_\".concat(item.id)\n          }, __jsx(\"img\", {\n            style: {\n              height: '160px'\n            },\n            src: dealImgUrl(item.imgUrl),\n            alt: \"\",\n            className: _JSXStyle.dynamic([[\"1873098083\", [grey[600]]]])\n          }), __jsx(\"aside\", {\n            className: _JSXStyle.dynamic([[\"1873098083\", [grey[600]]]])\n          }, __jsx(\"section\", {\n            className: _JSXStyle.dynamic([[\"1873098083\", [grey[600]]]])\n          }, item === null || item === void 0 ? void 0 : (_item$objData = item.objData) === null || _item$objData === void 0 ? void 0 : _item$objData.remark), (item === null || item === void 0 ? void 0 : (_item$objData2 = item.objData) === null || _item$objData2 === void 0 ? void 0 : _item$objData2.effectiveDateStart) && __jsx(\"main\", {\n            className: _JSXStyle.dynamic([[\"1873098083\", [grey[600]]]])\n          }, formatDate(item === null || item === void 0 ? void 0 : (_item$objData3 = item.objData) === null || _item$objData3 === void 0 ? void 0 : _item$objData3.effectiveDateStart, 'YYYY/MM/dd'), \"-\", formatDate(item === null || item === void 0 ? void 0 : (_item$objData4 = item.objData) === null || _item$objData4 === void 0 ? void 0 : _item$objData4.effectiveDateEnd, 'YYYY/MM/dd'))));\n        },\n        onClickItem: function onClickItem(index) {\n          var _filterList$index, _filterList$index2, _stateHomeTabsModel$a, _filterList$index3, _stateHomeTabsModel$a2;\n\n          if ((filterList === null || filterList === void 0 ? void 0 : (_filterList$index = filterList[index]) === null || _filterList$index === void 0 ? void 0 : _filterList$index.relatedObjType) === RelatedObjTypeEnum.PromoCode) {\n            router.push('/m/card');\n          }\n\n          if ((filterList === null || filterList === void 0 ? void 0 : (_filterList$index2 = filterList[index]) === null || _filterList$index2 === void 0 ? void 0 : _filterList$index2.relatedObjType) === RelatedObjTypeEnum.PromotionFlashSale && (stateHomeTabsModel === null || stateHomeTabsModel === void 0 ? void 0 : (_stateHomeTabsModel$a = stateHomeTabsModel.appModuleConfig) === null || _stateHomeTabsModel$a === void 0 ? void 0 : _stateHomeTabsModel$a[AppModuleTypeEnum.limitTime])) {\n            router.push(\"/m/home/[appModule]\", \"/m/home/\".concat(AppModuleTypeEnum.limitTime));\n          }\n\n          if ((filterList === null || filterList === void 0 ? void 0 : (_filterList$index3 = filterList[index]) === null || _filterList$index3 === void 0 ? void 0 : _filterList$index3.relatedObjType) === RelatedObjTypeEnum.PromotionThemeSelect && (stateHomeTabsModel === null || stateHomeTabsModel === void 0 ? void 0 : (_stateHomeTabsModel$a2 = stateHomeTabsModel.appModuleConfig) === null || _stateHomeTabsModel$a2 === void 0 ? void 0 : _stateHomeTabsModel$a2[AppModuleTypeEnum.themeSelection])) {\n            router.push(\"/m/home/[appModule]\", \"/m/home/\".concat(AppModuleTypeEnum.themeSelection));\n          }\n        }\n      });\n    }()), __jsx(\"div\", {\n      className: _JSXStyle.dynamic([[\"1873098083\", [grey[600]]]])\n    }, __jsx(HomeTabs, {\n      homeType: type !== null && type !== void 0 ? type : HomeType.home\n    }))), __jsx(_JSXStyle, {\n      id: \"1873098083\",\n      dynamic: [grey[600]]\n    }, [\".common_box.__jsx-style-dynamic-selector{padding-top:3.125vw;padding-bottom:37.5vw;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;-webkit-flex-shrink:1;-ms-flex-negative:1;flex-shrink:1;overflow:auto;}\", \".common_box.__jsx-style-dynamic-selector>*.__jsx-style-dynamic-selector{margin-left:3.125vw;margin-right:3.125vw;}\", \".tip.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;color:\".concat(grey[600], \";padding:2.5vw 0;}\"), \".tip.__jsx-style-dynamic-selector>span.__jsx-style-dynamic-selector{margin:0 3.125vw;}\", \".cusCarousel.__jsx-style-dynamic-selector{border-radius:3.125vw;overflow:hidden;}\", \".footer.__jsx-style-dynamic-selector{height:62.5vw;}\"])), __jsx(FootBar, null));\n  };\n};","map":null,"metadata":{},"sourceType":"module"}