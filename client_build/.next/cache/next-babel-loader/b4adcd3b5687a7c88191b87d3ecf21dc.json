{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport { HeaderTitle } from '../../../components/HeaderTitle/HeaderTitle';\nimport { BScroller } from '../../../components/BScroll/BScroller';\nimport styled from 'styled-components';\nimport { modelFactory } from '../../../ModelAction/modelUtil';\nimport { doc } from '../../../graphqlTypes/doc';\nimport { dealMoney, formatDate, fpMergePre } from '../../../tools/utils';\nimport { useStoreModel } from '../../../ModelAction/useStore';\nimport { useRouter } from 'next/router';\nimport { ls } from '../../../tools/dealKey';\nimport { orderStateToString, PickUpTypeEnum } from '../../../ss_common/enum';\nimport { mpStyle } from '../../../style/common';\nimport { grey } from '@material-ui/core/colors';\nimport { dealImgUrl } from '../../../tools/img';\nimport { Button } from '@material-ui/core';\nexport var orderDetailModel = modelFactory('orderDetail', {\n  orderInfo: {},\n  selfAddress: []\n}, {\n  getDetail: function () {\n    var _getDetail = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value, option) {\n      var _res$selfAddress, _res$selfAddress$valu;\n\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return option.query(doc.orderDetail, {\n                id: value\n              });\n\n            case 2:\n              res = _context.sent;\n              option.setData(fpMergePre({\n                orderInfo: res === null || res === void 0 ? void 0 : res.orderDetail,\n                selfAddress: (res === null || res === void 0 ? void 0 : (_res$selfAddress = res.selfAddress) === null || _res$selfAddress === void 0 ? void 0 : (_res$selfAddress$valu = _res$selfAddress.value) === null || _res$selfAddress$valu === void 0 ? void 0 : _res$selfAddress$valu.list) || []\n              }));\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function getDetail(_x, _x2) {\n      return _getDetail.apply(this, arguments);\n    }\n\n    return getDetail;\n  }()\n});\nvar Box = styled.div.withConfig({\n  displayName: \"orderDetail__Box\",\n  componentId: \"lz0d8y-0\"\n})([\"padding:0 20px;\"]);\nvar Top = styled.div.withConfig({\n  displayName: \"orderDetail__Top\",\n  componentId: \"lz0d8y-1\"\n})([\"margin-top:10px;font-size:18px;display:flex;> aside{margin-left:20px;color:\", \";}\"], mpStyle.red);\nvar InfoLabel = styled.div.withConfig({\n  displayName: \"orderDetail__InfoLabel\",\n  componentId: \"lz0d8y-2\"\n})([\"display:flex;margin-top:16px;> aside{color:\", \";width:80px;}\"], grey[600]);\nvar GreyPart = styled.div.withConfig({\n  displayName: \"orderDetail__GreyPart\",\n  componentId: \"lz0d8y-3\"\n})([\"margin-top:12px;position:relative;left:-20px;width:100vw;height:12px;background:\", \";\"], grey[200]);\nvar ProductBox = styled.div.withConfig({\n  displayName: \"orderDetail__ProductBox\",\n  componentId: \"lz0d8y-4\"\n})([\"display:grid;padding-top:4vw;margin-bottom:10px;grid-template-columns:min-content 1fr 30vw;> img{grid-area:1/1/4/2;width:20vw;height:20vw;margin-right:14px;}> section{grid-area:1/2/2/4;font-size:20px;}> main{padding:10px 0;grid-area:2/2/3/4;font-size:14px;color:\", \";}> footer{display:flex;> aside{text-decoration:line-through;}> span{margin-left:5px;color:\", \";font-size:17px;}}> aside{> button{border-radius:10px;padding:2px 14px;}}\"], grey[500], mpStyle.red);\nvar Sum = styled.div.withConfig({\n  displayName: \"orderDetail__Sum\",\n  componentId: \"lz0d8y-5\"\n})([\"display:flex;justify-content:space-between;margin-bottom:12px;\"]);\nexport var OrderDetail = function OrderDetail() {\n  var _orderInfo$userAddres, _orderInfo$userPayCar, _orderInfo$userPayCar2, _orderInfo$userPayCar3, _orderInfo$rOrderProd;\n\n  var router = useRouter();\n\n  var _useStoreModel = useStoreModel(orderDetailModel),\n      stateOD = _useStoreModel.state,\n      actionsOD = _useStoreModel.actions;\n\n  var orderInfo = stateOD.orderInfo;\n  useEffect(function () {\n    var _stateOD$orderInfo;\n\n    if (router.query.id && !((_stateOD$orderInfo = stateOD.orderInfo) === null || _stateOD$orderInfo === void 0 ? void 0 : _stateOD$orderInfo.id)) {\n      var _router$query;\n\n      actionsOD.getDetail(\"\".concat((_router$query = router.query) === null || _router$query === void 0 ? void 0 : _router$query.id));\n    }\n  }, [router.query.id, stateOD.orderInfo]);\n  return __jsx(\"div\", null, __jsx(HeaderTitle, {\n    title: '订单详情'\n  }), !(orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.id) ? __jsx(\"div\", null) : __jsx(BScroller, {\n    boxHeight: 'calc(100vh - 60px)'\n  }, __jsx(Box, null, __jsx(Top, null, __jsx(\"section\", null, ls(formatDate(orderInfo.createTime))), __jsx(\"aside\", null, orderStateToString(orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.state))), __jsx(InfoLabel, null, __jsx(\"aside\", null, ls('送货地址'), \" :\"), __jsx(\"section\", null, orderInfo.pickUpType === PickUpTypeEnum.Self && function (v) {\n    return \"\".concat(v.province, \" \").concat(v.city, \" \").concat(v.streetAddress);\n  }(stateOD.selfAddress.find(function (v) {\n    return v.id === orderInfo.selfAddressId;\n  })) || ((_orderInfo$userAddres = orderInfo.userAddress) === null || _orderInfo$userAddres === void 0 ? void 0 : _orderInfo$userAddres.combineAddress))), __jsx(InfoLabel, null, __jsx(\"aside\", null, ls('订单编号'), \" :\"), __jsx(\"section\", null, orderInfo.number)), __jsx(InfoLabel, null, __jsx(\"aside\", null, ls('支付方式'), \" :\"), __jsx(\"section\", null, __jsx(\"header\", null, orderInfo === null || orderInfo === void 0 ? void 0 : (_orderInfo$userPayCar = orderInfo.userPayCard) === null || _orderInfo$userPayCar === void 0 ? void 0 : _orderInfo$userPayCar.code), __jsx(\"main\", null, formatDate(orderInfo === null || orderInfo === void 0 ? void 0 : (_orderInfo$userPayCar2 = orderInfo.userPayCard) === null || _orderInfo$userPayCar2 === void 0 ? void 0 : _orderInfo$userPayCar2.expirationTime, 'MM/yy')), __jsx(\"footer\", null, orderInfo === null || orderInfo === void 0 ? void 0 : (_orderInfo$userPayCar3 = orderInfo.userPayCard) === null || _orderInfo$userPayCar3 === void 0 ? void 0 : _orderInfo$userPayCar3.userName))), __jsx(GreyPart, null), (_orderInfo$rOrderProd = orderInfo.rOrderProduct) === null || _orderInfo$rOrderProd === void 0 ? void 0 : _orderInfo$rOrderProd.map(function (rOrderProduct) {\n    var _rOrderProduct$produc, _rOrderProduct$produc2, _rOrderProduct$produc3, _rOrderProduct$produc4, _rOrderProduct$produc5, _rOrderProduct$produc6;\n\n    return __jsx(ProductBox, {\n      key: \"ProductBox_\".concat(rOrderProduct.id)\n    }, __jsx(\"img\", {\n      src: dealImgUrl((_rOrderProduct$produc = rOrderProduct.product) === null || _rOrderProduct$produc === void 0 ? void 0 : (_rOrderProduct$produc2 = _rOrderProduct$produc.img) === null || _rOrderProduct$produc2 === void 0 ? void 0 : (_rOrderProduct$produc3 = _rOrderProduct$produc2[0]) === null || _rOrderProduct$produc3 === void 0 ? void 0 : _rOrderProduct$produc3.url),\n      alt: \"\"\n    }), __jsx(\"section\", null, (_rOrderProduct$produc4 = rOrderProduct.product) === null || _rOrderProduct$produc4 === void 0 ? void 0 : _rOrderProduct$produc4.name), __jsx(\"main\", null, \"\\u72EC\\u7ACB\\u5305\\u88C5\"), __jsx(\"footer\", null, __jsx(\"aside\", null, dealMoney((_rOrderProduct$produc5 = rOrderProduct.product) === null || _rOrderProduct$produc5 === void 0 ? void 0 : _rOrderProduct$produc5.priceMarket)), __jsx(\"span\", null, dealMoney((_rOrderProduct$produc6 = rOrderProduct.product) === null || _rOrderProduct$produc6 === void 0 ? void 0 : _rOrderProduct$produc6.priceOut))), __jsx(\"aside\", null, __jsx(Button, {\n      variant: 'contained'\n    }, ls('加入购物车'))));\n  }), __jsx(\"div\", {\n    style: {\n      height: '26px',\n      width: '100%'\n    }\n  }), __jsx(Sum, null, __jsx(\"aside\", null, ls('小计')), __jsx(\"main\", null, dealMoney(orderInfo.subtotal))), __jsx(Sum, null, __jsx(\"aside\", null, ls('优惠券折扣')), __jsx(\"main\", null, dealMoney(0, '-'))), __jsx(Sum, null, __jsx(\"aside\", null, ls('运费')), __jsx(\"main\", null, dealMoney(orderInfo.transportationCosts))), __jsx(Sum, null, __jsx(\"aside\", null, ls('达人币抵扣')), __jsx(\"main\", null, dealMoney(orderInfo.deductCoin, '-'))), __jsx(Sum, null, __jsx(\"aside\", null, ls('消费税')), __jsx(\"main\", null, dealMoney(orderInfo.saleTax))), __jsx(Sum, null, __jsx(\"aside\", null, ls('实际支付')), __jsx(\"main\", null, dealMoney(orderInfo.actuallyPaid))), __jsx(Sum, null, __jsx(\"aside\", null, ls('获得达人币')), __jsx(\"main\", null, dealMoney(orderInfo.generateCoin))), __jsx(\"div\", {\n    style: {\n      height: '96px',\n      width: '100%'\n    }\n  }))));\n};","map":null,"metadata":{},"sourceType":"module"}