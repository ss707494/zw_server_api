{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport Router, { useRouter } from 'next/router';\nimport { useStoreModel } from '../../ModelAction/useStore';\nimport { KeyboardArrowRight } from '@material-ui/icons';\nimport { ButtonBase, LinearProgress } from '@material-ui/core';\nimport { fpMergePre } from '../../tools/utils';\nimport { HeaderTitle } from '../../components/HeaderTitle/HeaderTitle';\nimport { doc } from '../../graphqlTypes/doc';\nimport { BScroller } from '../../components/BScroll/BScroller';\nimport { modelFactory } from '../../ModelAction/modelUtil';\nimport styled from 'styled-components';\nimport { grey } from '@material-ui/core/colors';\nimport { dealImgUrl } from '../../tools/img';\nimport { ProductItem } from '../../components/ProductItem/ProductItem';\nimport { ls } from '../../tools/dealKey';\nimport { NoData } from '../../components/NoData/NoData';\nexport const CategoryPageModel = modelFactory('CategoryPage', {\n  productList: [],\n  categoryList: []\n}, {\n  getProductList: async (value, option) => {\n    var _res$productsInCatego, _res$categoryList$lis, _res$categoryList;\n\n    const res = await option.query(doc.productsInCategory, {\n      data: value\n    });\n    option.setData(fpMergePre({\n      productList: (_res$productsInCatego = res === null || res === void 0 ? void 0 : res.productsInCategory) !== null && _res$productsInCatego !== void 0 ? _res$productsInCatego : [],\n      categoryList: [...((_res$categoryList$lis = res === null || res === void 0 ? void 0 : (_res$categoryList = res.categoryList) === null || _res$categoryList === void 0 ? void 0 : _res$categoryList.list) !== null && _res$categoryList$lis !== void 0 ? _res$categoryList$lis : [])]\n    }));\n  }\n});\nconst Box = styled('div').withConfig({\n  displayName: \"id__Box\",\n  componentId: \"sc-13c54cm-0\"\n})([\"padding:0 20px;> header{font-size:18px;font-weight:bold;margin:10px 0;}\"]);\nconst CategoryItemStyle = styled(ButtonBase).withConfig({\n  displayName: \"id__CategoryItemStyle\",\n  componentId: \"sc-13c54cm-1\"\n})([\"&&&{width:100%;height:60px;display:flex;border-radius:8px;overflow:hidden;margin-bottom:10px;background:\", \";> img{height:100%;width:70%;}> span{flex:1;color:#fff;display:flex;align-items:center;justify-content:center;}}\"], grey[700]);\nconst categoryItemModel = modelFactory('categoryItemModel', {\n  test: ''\n}, {\n  getLevel: async (value, option) => {\n    return await option.query(doc.categoryLevel, {\n      data: value\n    });\n  }\n});\nconst ListBox = styled.div.withConfig({\n  displayName: \"id__ListBox\",\n  componentId: \"sc-13c54cm-2\"\n})([\"display:grid;grid-template-columns:repeat(2,1fr);grid-gap:15px;\"]);\nexport const CategoryPage = () => {\n  var _ref, _router$query;\n\n  const router = useRouter();\n  const id = (_ref = (_router$query = router.query) === null || _router$query === void 0 ? void 0 : _router$query.id) !== null && _ref !== void 0 ? _ref : '';\n  const {\n    state: stateCPM,\n    actions: actionsCPM,\n    getLoad\n  } = useStoreModel(CategoryPageModel);\n  const {\n    actions: actionsCI\n  } = useStoreModel(categoryItemModel);\n\n  const CategoryItem = v => {\n    return __jsx(CategoryItemStyle, {\n      key: `CategoryItem_${v.id}`,\n      onClick: async () => {\n        var _await$actionsCI$getL;\n\n        if (((_await$actionsCI$getL = await actionsCI.getLevel({\n          id: v.id\n        })) === null || _await$actionsCI$getL === void 0 ? void 0 : _await$actionsCI$getL.categoryLevel) === 3) {\n          await Router.push('/productList/[id]', `/productList/${v.id}`);\n        } else {\n          await Router.push('/category/[id]', `/category/${v.id}`);\n        }\n      }\n    }, __jsx(\"img\", {\n      src: dealImgUrl(v.imgUrl),\n      alt: \"\"\n    }), __jsx(\"span\", null, v.name, __jsx(KeyboardArrowRight, null)));\n  };\n\n  useEffect(() => {\n    if (id) {\n      actionsCPM.getProductList({\n        id\n      });\n    }\n  }, [id]);\n  return __jsx(\"div\", null, __jsx(HeaderTitle, {\n    title: ''\n  }), !!getLoad(doc.productsInCategory) && __jsx(LinearProgress, null), __jsx(BScroller, {\n    boxHeight: 'calc(100vh - 60px)'\n  }, __jsx(Box, null, stateCPM.categoryList.length === 0 && stateCPM.productList.length === 0 && __jsx(NoData, null) || __jsx(React.Fragment, null, stateCPM.categoryList.map(value => CategoryItem(value)), __jsx(\"header\", null, ls('热门推荐')), stateCPM.productList.length === 0 && __jsx(NoData, null), __jsx(ListBox, null, stateCPM.productList.map(value => __jsx(ProductItem, {\n    key: `ProductItem_${value.id}`,\n    product: value\n  })))))));\n};","map":null,"metadata":{},"sourceType":"module"}