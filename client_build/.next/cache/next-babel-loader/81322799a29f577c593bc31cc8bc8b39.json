{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect } from 'react';\nimport { modelFactory } from '../../../../../ModelAction/modelUtil';\nimport { useStoreModel } from '../../../../../ModelAction/useStore';\nimport { fpMergePre } from '../../../../../tools/utils';\nimport { SigninInput } from '../../../register';\nimport { FieldContain } from '../../myInfo/updatePassword';\nimport { HeaderTitle } from '../../../../../components/HeaderTitle/HeaderTitle';\nimport { setForm } from '../../../../../tools/commonAction';\nimport { ls } from '../../../../../tools/dealKey';\nimport { useRouter } from 'next/router';\nimport { ButtonLoad } from '../../../../../components/ButtonLoad/ButtonLoad';\nimport { doc } from '../../../../../graphqlTypes/doc';\nimport { showMessage } from '../../../../../components/Message/Message';\nimport { MenuItem, TextField } from '@material-ui/core';\nimport { ProvinceData } from '../../../../../ss_common/enum';\nexport const myAddressEditModel = modelFactory('myAddressEditModel', {\n  form: {\n    name: '',\n    address: '',\n    zip: '',\n    province: '',\n    city: '',\n    district: '',\n    contactInformation: ''\n  }\n}, {\n  setForm: setForm,\n  clearForm: (value, option) => option.setData(fpMergePre({\n    form: {\n      name: '',\n      address: '',\n      province: '',\n      zip: '',\n      city: '',\n      district: '',\n      contactInformation: ''\n    }\n  })),\n  submit: (value, option) => {\n    const form = option.data.form;\n    return option.mutate(doc.saveUserAddress, {\n      data: _objectSpread({}, form)\n    });\n  },\n  getOne: async (value, option) => {\n    var _res$userAddress;\n\n    const res = await option.query(doc.userAddress, {\n      data: _objectSpread({}, value)\n    });\n    option.setData(fpMergePre({\n      form: _objectSpread({}, (_res$userAddress = res === null || res === void 0 ? void 0 : res.userAddress) !== null && _res$userAddress !== void 0 ? _res$userAddress : {})\n    }));\n  }\n});\nexport const MyAddressEdit = () => {\n  var _ref, _router$query, _stateMAEM$form$provi;\n\n  const router = useRouter();\n  const id = (_ref = (_router$query = router.query) === null || _router$query === void 0 ? void 0 : _router$query.id) !== null && _ref !== void 0 ? _ref : '';\n  const {\n    state: stateMAEM,\n    actions: actionsMAEM\n  } = useStoreModel(myAddressEditModel);\n  useEffect(() => {\n    if (id && id !== '0') {\n      actionsMAEM.getOne({\n        id\n      });\n    }\n  }, [id]);\n  return __jsx(\"div\", null, __jsx(HeaderTitle, {\n    title: `${id === '0' ? '新增' : '编辑'}地址`,\n    backCall: actionsMAEM.clearForm\n  }), __jsx(FieldContain, null, [['姓名', 'name'], ['邮政编码', 'zip'], ['州', 'province', __jsx(TextField, {\n    key: 'myAddressEdit_province',\n    style: {\n      marginTop: '10px'\n    },\n    select: true,\n    fullWidth: true,\n    label: '州',\n    value: (_stateMAEM$form$provi = stateMAEM.form.province) !== null && _stateMAEM$form$provi !== void 0 ? _stateMAEM$form$provi : '',\n    onChange: e => actionsMAEM.setForm(['province', e.target.value])\n  }, ProvinceData.map(item => __jsx(MenuItem, {\n    key: `provinceData_${item[0]}`,\n    value: item[1]\n  }, item[1])))], ['城市', 'city'], ['地区', 'district'], ['详细地址', 'address'], ['联系方式', 'contactInformation']].map(v => {\n    var _stateMAEM$form;\n\n    return v[2] && v[2] || __jsx(SigninInput, {\n      key: `myAddressEdit_${v[1]}`,\n      label: ls(v[0]),\n      value: (_stateMAEM$form = stateMAEM.form[v[1]]) !== null && _stateMAEM$form !== void 0 ? _stateMAEM$form : '',\n      onChange: event => actionsMAEM.setForm([v[1], event.target.value])\n    });\n  }), __jsx(\"section\", {\n    style: {\n      width: '100%',\n      height: '20px'\n    }\n  }), __jsx(ButtonLoad, {\n    fullWidth: true,\n    variant: 'contained',\n    color: 'secondary',\n    onClick: async () => {\n      var _await$actionsMAEM$su, _await$actionsMAEM$su2;\n\n      if ((_await$actionsMAEM$su = await actionsMAEM.submit()) === null || _await$actionsMAEM$su === void 0 ? void 0 : (_await$actionsMAEM$su2 = _await$actionsMAEM$su.saveUserAddress) === null || _await$actionsMAEM$su2 === void 0 ? void 0 : _await$actionsMAEM$su2.id) {\n        showMessage('操作成功');\n        router.back();\n        actionsMAEM.clearForm();\n      }\n    }\n  }, \"\\u4FDD\\u5B58\")));\n};","map":null,"metadata":{},"sourceType":"module"}