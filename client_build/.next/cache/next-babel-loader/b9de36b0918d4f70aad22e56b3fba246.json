{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"D:\\\\code\\\\zw\\\\zw_client_web\\\\utils\\\\view\\\\m\\\\home\\\\appModule.tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/* eslint-disable react-hooks/rules-of-hooks */\nimport React, { useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport { AppModuleTypeEnum, DictTypeEnum, RelatedObjTypeEnum } from '../../../ss_common/enum';\nimport { modelFactory } from '../../../ModelAction/modelUtil';\nimport { HomeTabs, homeTabsModel } from './components/Tabs/Tabs';\nimport CusCarousel from '../../../components/Swipe/Swipe';\nimport { HeaderSearch } from '../../../components/HeaderSearch/HeaderSearch';\nimport { FootBar } from '../../../components/FootBar/FootBar';\nimport { BScroller } from '../../../components/BScroll/BScroller';\nimport { useStoreModel } from '../../../ModelAction/useStore';\nimport { getDataConfig, homeCarouselImgs } from '../../../graphqlTypes/doc';\nimport { formatDate, fpMergePre } from '../../../tools/utils';\nimport styled from 'styled-components';\nimport { dealImgUrl } from '../../../tools/img';\nimport { Space } from '../../../components/Box/Box';\nexport var HomeType = {\n  home: 'home',\n  group: 'group'\n};\nexport var homeCarouselModel = modelFactory('homeCarouselModel', {\n  homeCarouselImgs: []\n}, {\n  getHomeCarousel: function () {\n    var _getHomeCarousel = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value, option) {\n      var res2, _ref, __typename, rest, homeCarouselDataComfig;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return option.query(getDataConfig, {\n                data: {\n                  type: DictTypeEnum.HomeCarousel\n                }\n              }, {});\n\n            case 2:\n              res2 = _context.sent;\n              _ref = (res2 === null || res2 === void 0 ? void 0 : res2.getDataConfig) || {}, __typename = _ref.__typename, rest = _objectWithoutProperties(_ref, [\"__typename\"]);\n              _context.next = 6;\n              return option.query(homeCarouselImgs, {\n                data: _objectSpread({}, rest)\n              }, {});\n\n            case 6:\n              homeCarouselDataComfig = _context.sent;\n              option.setData(fpMergePre({\n                homeCarouselImgs: homeCarouselDataComfig === null || homeCarouselDataComfig === void 0 ? void 0 : homeCarouselDataComfig.homeCarouselImgs\n              }));\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function getHomeCarousel(_x, _x2) {\n      return _getHomeCarousel.apply(this, arguments);\n    }\n\n    return getHomeCarousel;\n  }()\n});\nvar CusSwipeImg = styled.div.withConfig({\n  displayName: \"appModule__CusSwipeImg\",\n  componentId: \"eet2po-0\"\n})([\"> aside{background:rgb(164,164,164,.4);color:white;position:absolute;top:4px;left:4px;padding:8px;border-radius:4px;font-size:small;display:flex;}\"]);\n_c = CusSwipeImg;\nvar CommonBox = styled.div.withConfig({\n  displayName: \"appModule__CommonBox\",\n  componentId: \"eet2po-1\"\n})([\"padding-top:10px;padding-bottom:120px;display:flex;flex-direction:column;flex-grow:1;flex-shrink:1;overflow:auto;> *{margin-left:10px;margin-right:10px;}\"]);\n_c2 = CommonBox;\nvar CusCarouselBox = styled.div.withConfig({\n  displayName: \"appModule__CusCarouselBox\",\n  componentId: \"eet2po-2\"\n})([\"border-radius:10px;overflow:hidden;\"]);\n_c3 = CusCarouselBox;\nexport var HomeAppModule = function HomeAppModule(type) {\n  var _s = $RefreshSig$();\n\n  return _s(function () {\n    var _this = this;\n\n    _s();\n\n    var router = useRouter();\n    useEffect(function () {\n      if (router.query.appModule && ![AppModuleTypeEnum.limitTime, AppModuleTypeEnum.mayLike, AppModuleTypeEnum.salesRank, AppModuleTypeEnum.themeSelection, AppModuleTypeEnum.categorySelection, AppModuleTypeEnum.lineRanking, AppModuleTypeEnum.topRanking].includes(router.query.appModule)) {\n        router.replace('/home/[appModule]', '/home/categorySelection', {});\n      }\n    });\n\n    var _useStoreModel = useStoreModel(homeCarouselModel),\n        actionsHomeCarouselModel = _useStoreModel.actions,\n        stateHomeCarouselModel = _useStoreModel.state;\n\n    var _useStoreModel2 = useStoreModel(homeTabsModel),\n        actionsHomeTabs = _useStoreModel2.actions,\n        stateHomeTabsModel = _useStoreModel2.state;\n\n    useEffect(function () {\n      actionsHomeCarouselModel.getHomeCarousel();\n      actionsHomeTabs.getData();\n    }, [actionsHomeCarouselModel, actionsHomeTabs]);\n    useEffect(function () {\n      actionsHomeTabs.setHomeType(type !== null && type !== void 0 ? type : HomeType.home);\n    }, [actionsHomeTabs]);\n    return __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 7\n      }\n    }, __jsx(HeaderSearch, {\n      homeType: type !== null && type !== void 0 ? type : HomeType.home,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }\n    }), __jsx(BScroller, {\n      boxHeight: 'calc(100vh - 65px)',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }\n    }, __jsx(CommonBox, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 11\n      }\n    }, __jsx(CusCarouselBox, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }\n    }, function () {\n      var _stateHomeCarouselMod, _stateHomeCarouselMod2, _stateHomeCarouselMod3, _stateHomeCarouselMod4;\n\n      var filterList = (_stateHomeCarouselMod = (_stateHomeCarouselMod2 = stateHomeCarouselModel.homeCarouselImgs) === null || _stateHomeCarouselMod2 === void 0 ? void 0 : (_stateHomeCarouselMod3 = _stateHomeCarouselMod2.value) === null || _stateHomeCarouselMod3 === void 0 ? void 0 : (_stateHomeCarouselMod4 = _stateHomeCarouselMod3.list) === null || _stateHomeCarouselMod4 === void 0 ? void 0 : _stateHomeCarouselMod4.filter(function (v) {\n        return !v.isDisabled;\n      })) !== null && _stateHomeCarouselMod !== void 0 ? _stateHomeCarouselMod : [];\n      return __jsx(CusCarousel, {\n        height: '160px',\n        dataList: filterList,\n        renderItem: function renderItem(item) {\n          var _item$objData, _item$objData2, _item$objData3, _item$objData4, _item$objData5, _item$objData6, _item$objData7;\n\n          return __jsx(CusSwipeImg, {\n            key: \"Carousel_\".concat(item.id),\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 41\n            }\n          }, __jsx(\"img\", {\n            style: {\n              height: '160px'\n            },\n            src: dealImgUrl(item.imgUrl),\n            alt: \"\",\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 23\n            }\n          }), __jsx(\"aside\", {\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 23\n            }\n          }, __jsx(\"section\", {\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 25\n            }\n          }, item === null || item === void 0 ? void 0 : (_item$objData = item.objData) === null || _item$objData === void 0 ? void 0 : _item$objData.remark), __jsx(Space, {\n            w: 4,\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 25\n            }\n          }), (item === null || item === void 0 ? void 0 : (_item$objData2 = item.objData) === null || _item$objData2 === void 0 ? void 0 : _item$objData2.effectiveDateStart) && __jsx(\"main\", {\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 118,\n              columnNumber: 25\n            }\n          }, \"[ \", formatDate(item === null || item === void 0 ? void 0 : (_item$objData3 = item.objData) === null || _item$objData3 === void 0 ? void 0 : _item$objData3.effectiveDateStart, 'YYYY/MM/dd'), \" - \", formatDate(item === null || item === void 0 ? void 0 : (_item$objData4 = item.objData) === null || _item$objData4 === void 0 ? void 0 : _item$objData4.effectiveDateEnd, 'YYYY/MM/dd'), \" ]\"), (item === null || item === void 0 ? void 0 : (_item$objData5 = item.objData) === null || _item$objData5 === void 0 ? void 0 : _item$objData5.startTime) && __jsx(\"main\", {\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 25\n            }\n          }, \"[ \", formatDate(item === null || item === void 0 ? void 0 : (_item$objData6 = item.objData) === null || _item$objData6 === void 0 ? void 0 : _item$objData6.startTime, 'YYYY/MM/dd'), \" - \", formatDate(item === null || item === void 0 ? void 0 : (_item$objData7 = item.objData) === null || _item$objData7 === void 0 ? void 0 : _item$objData7.endTime, 'YYYY/MM/dd'), \" ]\")));\n        },\n        onClickItem: function onClickItem(index) {\n          var _filterList$index, _filterList$index2, _stateHomeTabsModel$a, _filterList$index3, _stateHomeTabsModel$a2;\n\n          if ((filterList === null || filterList === void 0 ? void 0 : (_filterList$index = filterList[index]) === null || _filterList$index === void 0 ? void 0 : _filterList$index.relatedObjType) === RelatedObjTypeEnum.PromoCode) {\n            router.push('/m/card');\n          }\n\n          if ((filterList === null || filterList === void 0 ? void 0 : (_filterList$index2 = filterList[index]) === null || _filterList$index2 === void 0 ? void 0 : _filterList$index2.relatedObjType) === RelatedObjTypeEnum.PromotionFlashSale && (stateHomeTabsModel === null || stateHomeTabsModel === void 0 ? void 0 : (_stateHomeTabsModel$a = stateHomeTabsModel.appModuleConfig) === null || _stateHomeTabsModel$a === void 0 ? void 0 : _stateHomeTabsModel$a[AppModuleTypeEnum.limitTime])) {\n            router.push(\"/m/home/[appModule]\", \"/m/home/\".concat(AppModuleTypeEnum.limitTime));\n          }\n\n          if ((filterList === null || filterList === void 0 ? void 0 : (_filterList$index3 = filterList[index]) === null || _filterList$index3 === void 0 ? void 0 : _filterList$index3.relatedObjType) === RelatedObjTypeEnum.PromotionThemeSelect && (stateHomeTabsModel === null || stateHomeTabsModel === void 0 ? void 0 : (_stateHomeTabsModel$a2 = stateHomeTabsModel.appModuleConfig) === null || _stateHomeTabsModel$a2 === void 0 ? void 0 : _stateHomeTabsModel$a2[AppModuleTypeEnum.themeSelection])) {\n            router.push(\"/m/home/[appModule]\", \"/m/home/\".concat(AppModuleTypeEnum.themeSelection));\n          }\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 24\n        }\n      });\n    }()), __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 13\n      }\n    }, __jsx(HomeTabs, {\n      homeType: type !== null && type !== void 0 ? type : HomeType.home,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 15\n      }\n    })))), __jsx(FootBar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 9\n      }\n    }));\n  }, \"TDRSc1H4JFtEyb6uomAE41B1E5A=\", false, function () {\n    return [useRouter, useStoreModel, useStoreModel];\n  });\n};\n_c4 = HomeAppModule;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"CusSwipeImg\");\n$RefreshReg$(_c2, \"CommonBox\");\n$RefreshReg$(_c3, \"CusCarouselBox\");\n$RefreshReg$(_c4, \"HomeAppModule\");","map":{"version":3,"sources":["D:/code/zw/zw_client_web/utils/view/m/home/appModule.tsx"],"names":["React","useEffect","useRouter","AppModuleTypeEnum","DictTypeEnum","RelatedObjTypeEnum","modelFactory","HomeTabs","homeTabsModel","CusCarousel","HeaderSearch","FootBar","BScroller","useStoreModel","getDataConfig","homeCarouselImgs","formatDate","fpMergePre","styled","dealImgUrl","Space","HomeType","home","group","homeCarouselModel","getHomeCarousel","value","option","query","data","type","HomeCarousel","res2","__typename","rest","homeCarouselDataComfig","setData","CusSwipeImg","div","CommonBox","CusCarouselBox","HomeAppModule","router","appModule","limitTime","mayLike","salesRank","themeSelection","categorySelection","lineRanking","topRanking","includes","replace","actionsHomeCarouselModel","actions","stateHomeCarouselModel","state","actionsHomeTabs","stateHomeTabsModel","getData","setHomeType","filterList","list","filter","v","isDisabled","item","id","height","imgUrl","objData","remark","effectiveDateStart","effectiveDateEnd","startTime","endTime","index","relatedObjType","PromoCode","push","PromotionFlashSale","appModuleConfig","PromotionThemeSelect"],"mappings":"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","sourcesContent":["/* eslint-disable react-hooks/rules-of-hooks */\r\nimport React, {useEffect} from 'react'\r\nimport {useRouter} from 'next/router'\r\nimport {AppModuleTypeEnum, DictTypeEnum, RelatedObjTypeEnum} from '../../../ss_common/enum'\r\nimport {DataConfig, DataConfigItemInput} from '../../../graphqlTypes/types'\r\nimport {modelFactory} from '../../../ModelAction/modelUtil'\r\nimport {HomeTabs, homeTabsModel} from './components/Tabs/Tabs'\r\nimport CusCarousel from '../../../components/Swipe/Swipe'\r\nimport {HeaderSearch} from '../../../components/HeaderSearch/HeaderSearch'\r\nimport {FootBar} from '../../../components/FootBar/FootBar'\r\nimport {BScroller} from '../../../components/BScroll/BScroller'\r\nimport {useStoreModel} from '../../../ModelAction/useStore'\r\nimport {getDataConfig, homeCarouselImgs} from '../../../graphqlTypes/doc'\r\nimport {formatDate, fpMergePre} from '../../../tools/utils'\r\nimport styled from 'styled-components'\r\nimport {dealImgUrl} from '../../../tools/img'\r\nimport {Space} from '../../../components/Box/Box'\r\n\r\nexport const HomeType = {\r\n  home: 'home',\r\n  group: 'group',\r\n}\r\n\r\nexport const homeCarouselModel = modelFactory('homeCarouselModel', {\r\n  homeCarouselImgs: [] as DataConfig,\r\n}, {\r\n  getHomeCarousel: async (value, option) => {\r\n    const res2 = await option.query(getDataConfig, {\r\n      data: {\r\n        type: DictTypeEnum.HomeCarousel,\r\n      } as DataConfigItemInput,\r\n    }, {})\r\n    const {__typename, ...rest} = res2?.getDataConfig || {}\r\n    const homeCarouselDataComfig = await option.query(homeCarouselImgs, {\r\n      data: {\r\n        ...rest,\r\n      } as DataConfigItemInput,\r\n    }, {})\r\n    option.setData(fpMergePre({\r\n      homeCarouselImgs: homeCarouselDataComfig?.homeCarouselImgs,\r\n    }))\r\n  },\r\n})\r\n\r\nconst CusSwipeImg = styled.div`\r\n  > aside {\r\n    background: rgb(164,164,164, .4);\r\n    color: white;\r\n    position: absolute;\r\n    top: 4px;\r\n    left: 4px;\r\n    padding: 8px;\r\n    border-radius: 4px;\r\n    font-size: small;\r\n    display: flex;\r\n  }\r\n`\r\nconst CommonBox = styled.div`\r\n  padding-top: 10px;\r\n  padding-bottom: 120px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  flex-grow: 1;\r\n  flex-shrink: 1;\r\n  overflow: auto;\r\n  > * {\r\n    margin-left: 10px;\r\n    margin-right: 10px;\r\n  }\r\n`\r\n\r\nconst CusCarouselBox = styled.div`\r\n  border-radius: 10px;\r\n  overflow: hidden;\r\n`\r\n\r\nexport const HomeAppModule = (type?: string) => function () {\r\n  const router = useRouter()\r\n  useEffect(() => {\r\n    if (router.query.appModule && !([AppModuleTypeEnum.limitTime, AppModuleTypeEnum.mayLike, AppModuleTypeEnum.salesRank, AppModuleTypeEnum.themeSelection, AppModuleTypeEnum.categorySelection, AppModuleTypeEnum.lineRanking, AppModuleTypeEnum.topRanking] as any[]).includes(router.query.appModule)\r\n    ) {\r\n      router.replace('/home/[appModule]', '/home/categorySelection', {})\r\n    }\r\n  })\r\n\r\n  const {actions: actionsHomeCarouselModel, state: stateHomeCarouselModel} = useStoreModel(homeCarouselModel)\r\n  const {actions: actionsHomeTabs, state: stateHomeTabsModel} = useStoreModel(homeTabsModel)\r\n  useEffect(() => {\r\n    actionsHomeCarouselModel.getHomeCarousel()\r\n    actionsHomeTabs.getData()\r\n  }, [actionsHomeCarouselModel, actionsHomeTabs])\r\n  useEffect(() => {\r\n    actionsHomeTabs.setHomeType((type) ?? HomeType.home)\r\n  }, [actionsHomeTabs])\r\n\r\n  return (\r\n      <div>\r\n        <HeaderSearch homeType={type ?? HomeType.home}/>\r\n        <BScroller boxHeight={'calc(100vh - 65px)'}>\r\n          <CommonBox>\r\n            <CusCarouselBox>\r\n              {(() => {\r\n                const filterList = stateHomeCarouselModel.homeCarouselImgs?.value?.list?.filter((v: any) => !v.isDisabled) ?? []\r\n                return <CusCarousel\r\n                    height={'160px'}\r\n                    dataList={filterList as []}\r\n                    renderItem={item => <CusSwipeImg\r\n                        key={`Carousel_${item.id}`}\r\n                    >\r\n                      <img\r\n                          style={{height: '160px'}}\r\n                          src={dealImgUrl(item.imgUrl)}\r\n                          alt=\"\"/>\r\n                      <aside>\r\n                        <section>{item?.objData?.remark}</section>\r\n                        <Space w={4}/>\r\n                        {item?.objData?.effectiveDateStart &&\r\n                        <main>[ {formatDate(item?.objData?.effectiveDateStart, 'YYYY/MM/dd')} - {formatDate(item?.objData?.effectiveDateEnd, 'YYYY/MM/dd')} ]</main>}\r\n                        {item?.objData?.startTime &&\r\n                        <main>[ {formatDate(item?.objData?.startTime, 'YYYY/MM/dd')} - {formatDate(item?.objData?.endTime, 'YYYY/MM/dd')} ]</main>}\r\n                      </aside>\r\n                    </CusSwipeImg>}\r\n                    onClickItem={(index) => {\r\n                      if (filterList?.[index]?.relatedObjType === RelatedObjTypeEnum.PromoCode) {\r\n                        router.push('/m/card')\r\n                      }\r\n                      if (filterList?.[index]?.relatedObjType === RelatedObjTypeEnum.PromotionFlashSale\r\n                          && stateHomeTabsModel?.appModuleConfig?.[AppModuleTypeEnum.limitTime]) {\r\n                        router.push(`/m/home/[appModule]`, `/m/home/${AppModuleTypeEnum.limitTime}`)\r\n                      }\r\n                      if (filterList?.[index]?.relatedObjType === RelatedObjTypeEnum.PromotionThemeSelect\r\n                          && stateHomeTabsModel?.appModuleConfig?.[AppModuleTypeEnum.themeSelection]) {\r\n                        router.push(`/m/home/[appModule]`, `/m/home/${AppModuleTypeEnum.themeSelection}`)\r\n                      }\r\n                    }}\r\n                />\r\n              })()}\r\n            </CusCarouselBox>\r\n            <div>\r\n              <HomeTabs homeType={type ?? HomeType.home}/>\r\n            </div>\r\n          </CommonBox>\r\n        </BScroller>\r\n        <FootBar/>\r\n      </div>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}