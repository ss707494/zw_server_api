{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport PaymentIcon from '@material-ui/icons/Payment';\nimport { HeaderTitle } from '../../../../components/HeaderTitle/HeaderTitle';\nimport { modelFactory } from '../../../../ModelAction/modelUtil';\nimport { doc } from '../../../../graphqlTypes/doc';\nimport { formatDate, fpMergePre } from '../../../../tools/utils';\nimport { useStoreModel } from '../../../../ModelAction/useStore';\nimport styled from 'styled-components';\nimport { Button, IconButton } from '@material-ui/core';\nimport { ls } from '../../../../tools/dealKey';\nimport { grey } from '@material-ui/core/colors';\nimport { useRouter } from 'next/router';\nimport { showMessage } from '../../../../components/Message/Message';\nimport EditIcon from '@material-ui/icons/Edit';\nimport { DefaultBox } from '../myAddress/list';\nvar myCreditCardListModel = modelFactory('myCreditCardListModel', {\n  list: []\n}, {\n  getList: function () {\n    var _getList = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value, option) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return option.query(doc.payCardListOneUser);\n\n            case 2:\n              res = _context.sent;\n              option.setData(fpMergePre({\n                list: res === null || res === void 0 ? void 0 : res.payCardListOneUser\n              }));\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function getList(_x, _x2) {\n      return _getList.apply(this, arguments);\n    }\n\n    return getList;\n  }(),\n  setDefault: function () {\n    var _setDefault = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(value, option) {\n      var _res$setUserPayCardDe;\n\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return option.mutate(doc.setUserPayCardDefault, {\n                data: {\n                  id: value.id\n                }\n              });\n\n            case 2:\n              res = _context2.sent;\n\n              if (res === null || res === void 0 ? void 0 : (_res$setUserPayCardDe = res.setUserPayCardDefault) === null || _res$setUserPayCardDe === void 0 ? void 0 : _res$setUserPayCardDe.id) {\n                showMessage('操作成功');\n              }\n\n              return _context2.abrupt(\"return\", res);\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    function setDefault(_x3, _x4) {\n      return _setDefault.apply(this, arguments);\n    }\n\n    return setDefault;\n  }()\n});\nvar ListBox = styled.div.withConfig({\n  displayName: \"list__ListBox\",\n  componentId: \"sc-1b9q25g-0\"\n})([\"\"]);\nvar ListItem = styled.div.withConfig({\n  displayName: \"list__ListItem\",\n  componentId: \"sc-1b9q25g-1\"\n})([\"display:flex;height:80px;align-items:center;padding-left:20px;border-bottom:1px solid \", \";> svg{}> main{margin-left:10px;flex-grow:1;> footer{margin-top:4px;font-size:small;color:\", \";}}\"], grey[200], grey[400]);\nexport var MyCreditCardList = function MyCreditCardList() {\n  var router = useRouter();\n\n  var _useStoreModel = useStoreModel(myCreditCardListModel),\n      stateMCC = _useStoreModel.state,\n      actionsMCC = _useStoreModel.actions;\n\n  useEffect(function () {\n    actionsMCC.getList();\n  }, []);\n  return __jsx(\"div\", null, __jsx(HeaderTitle, {\n    title: '我的信用卡'\n  }), __jsx(ListBox, null, stateMCC.list.map(function (value) {\n    var _value$number, _value$number2;\n\n    return __jsx(ListItem, {\n      key: \"MyCreditCardList_\".concat(value.id)\n    }, __jsx(PaymentIcon, {\n      fontSize: 'large'\n    }), __jsx(\"main\", null, __jsx(\"header\", null, ls('卡号'), \": **** **** **** \", (_value$number = value.number) === null || _value$number === void 0 ? void 0 : _value$number.slice(((_value$number2 = value.number) === null || _value$number2 === void 0 ? void 0 : _value$number2.length) - 4)), __jsx(\"footer\", null, ls('过期日'), \": \", formatDate(value === null || value === void 0 ? void 0 : value.expirationTime, 'MM/yy')), __jsx(\"footer\", null, value.name)), __jsx(\"aside\", null, value.isDefault && __jsx(DefaultBox, {\n      style: {\n        fontSize: '14px'\n      }\n    }, ls('默认')) || __jsx(Button, {\n      size: 'small',\n      color: 'secondary',\n      variant: 'outlined',\n      onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var _yield$actionsMCC$set, _yield$actionsMCC$set2;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return actionsMCC.setDefault(value);\n\n              case 2:\n                _context3.t1 = _yield$actionsMCC$set = _context3.sent;\n                _context3.t0 = _context3.t1 === null;\n\n                if (_context3.t0) {\n                  _context3.next = 6;\n                  break;\n                }\n\n                _context3.t0 = _yield$actionsMCC$set === void 0;\n\n              case 6:\n                if (!_context3.t0) {\n                  _context3.next = 10;\n                  break;\n                }\n\n                _context3.t2 = void 0;\n                _context3.next = 11;\n                break;\n\n              case 10:\n                _context3.t2 = (_yield$actionsMCC$set2 = _yield$actionsMCC$set.setUserPayCardDefault) === null || _yield$actionsMCC$set2 === void 0 ? void 0 : _yield$actionsMCC$set2.id;\n\n              case 11:\n                if (!_context3.t2) {\n                  _context3.next = 13;\n                  break;\n                }\n\n                actionsMCC.getList();\n\n              case 13:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }))\n    }, ls('设为默认')), __jsx(IconButton, {\n      onClick: function onClick() {\n        return router.push('/m/me/myCreditCard/edit/[id]', \"/m/me/myCreditCard/edit/\".concat(value.id));\n      }\n    }, __jsx(EditIcon, null))));\n  })), __jsx(\"div\", {\n    style: {\n      padding: '0 20px',\n      marginTop: '20px'\n    }\n  }, __jsx(Button, {\n    fullWidth: true,\n    variant: 'contained',\n    color: 'secondary',\n    onClick: function onClick() {\n      return router.push('/m/me/myCreditCard/edit/[id]', \"/m/me/myCreditCard/edit/0\");\n    }\n  }, ls('新增'))));\n};","map":null,"metadata":{},"sourceType":"module"}