{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect } from 'react';\nimport { modelFactory } from '../../../../../ModelAction/modelUtil';\nimport { useStoreModel } from '../../../../../ModelAction/useStore';\nimport { fpMergePre } from '../../../../../tools/utils';\nimport { SigninInput } from '../../../register';\nimport { FieldContain } from '../../myInfo/updatePassword';\nimport { HeaderTitle } from '../../../../../components/HeaderTitle/HeaderTitle';\nimport { setForm } from '../../../../../tools/commonAction';\nimport { ll } from '../../../../../tools/dealKey';\nimport { useRouter } from 'next/router';\nimport { ButtonLoad } from '../../../../../components/ButtonLoad/ButtonLoad';\nimport { doc } from '../../../../../graphqlTypes/doc';\nimport { showMessage } from '../../../../../components/Message/Message';\nimport { MenuItem, TextField } from '@material-ui/core';\nimport { ProvinceData } from '../../../../../ss_common/enum';\nexport var myAddressEditModel = modelFactory('myAddressEditModel', {\n  form: {\n    name: '',\n    address: '',\n    zip: '',\n    province: '',\n    city: '',\n    district: '',\n    contactInformation: ''\n  }\n}, {\n  setForm: setForm,\n  clearForm: function clearForm(value, option) {\n    return option.setData(fpMergePre({\n      form: {\n        name: '',\n        address: '',\n        province: '',\n        zip: '',\n        city: '',\n        district: '',\n        contactInformation: ''\n      }\n    }));\n  },\n  submit: function submit(value, option) {\n    var _option$data$form = option.data.form,\n        id = _option$data$form.id,\n        form = _objectWithoutProperties(_option$data$form, [\"id\"]);\n\n    return option.mutate(doc.saveUserAddress, {\n      data: _objectSpread(_objectSpread({}, form), id ? {\n        id: id\n      } : {})\n    });\n  },\n  getOne: function () {\n    var _getOne = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(value, option) {\n      var _res$userAddress;\n\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return option.query(doc.userAddress, {\n                data: _objectSpread({}, value)\n              });\n\n            case 2:\n              res = _context.sent;\n              option.setData(fpMergePre({\n                form: _objectSpread({}, (_res$userAddress = res === null || res === void 0 ? void 0 : res.userAddress) !== null && _res$userAddress !== void 0 ? _res$userAddress : {})\n              }));\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function getOne(_x, _x2) {\n      return _getOne.apply(this, arguments);\n    }\n\n    return getOne;\n  }()\n});\nexport var MyAddressEdit = function MyAddressEdit() {\n  var _ref, _router$query, _stateMAEM$form$provi;\n\n  var router = useRouter();\n  var id = (_ref = (_router$query = router.query) === null || _router$query === void 0 ? void 0 : _router$query.id) !== null && _ref !== void 0 ? _ref : '';\n\n  var _useStoreModel = useStoreModel(myAddressEditModel),\n      stateMAEM = _useStoreModel.state,\n      actionsMAEM = _useStoreModel.actions;\n\n  useEffect(function () {\n    if (id && id !== '0') {\n      actionsMAEM.getOne({\n        id: id\n      });\n    } else {\n      actionsMAEM.setForm(['id', '']);\n    }\n  }, [id]);\n  return __jsx(\"div\", null, __jsx(HeaderTitle, {\n    title: \"\".concat(id === '0' ? '新增' : '编辑', \"\\u5730\\u5740\"),\n    backCall: actionsMAEM.clearForm\n  }), __jsx(FieldContain, null, [['姓名', 'name'], ['详细地址', 'address'], ['地区', 'district'], ['城市', 'city'], ['州', 'province', __jsx(TextField, {\n    key: 'myAddressEdit_province',\n    style: {\n      marginTop: '10px'\n    },\n    select: true,\n    fullWidth: true,\n    label: '州',\n    value: (_stateMAEM$form$provi = stateMAEM.form.province) !== null && _stateMAEM$form$provi !== void 0 ? _stateMAEM$form$provi : '',\n    onChange: function onChange(e) {\n      return actionsMAEM.setForm(['province', e.target.value]);\n    }\n  }, ProvinceData.map(function (item) {\n    return __jsx(MenuItem, {\n      key: \"provinceData_\".concat(item[0]),\n      value: item[1]\n    }, item[1]);\n  }))], ['邮政编码', 'zip'], ['联系方式', 'contactInformation']].map(function (v) {\n    var _stateMAEM$form;\n\n    return v[2] && v[2] || __jsx(SigninInput, {\n      key: \"myAddressEdit_\".concat(v[1]),\n      label: ll(v[0]),\n      value: (_stateMAEM$form = stateMAEM.form[v[1]]) !== null && _stateMAEM$form !== void 0 ? _stateMAEM$form : '',\n      onChange: function onChange(event) {\n        return actionsMAEM.setForm([v[1], event.target.value]);\n      }\n    });\n  }), __jsx(\"section\", {\n    style: {\n      width: '100%',\n      height: '20px'\n    }\n  }), __jsx(ButtonLoad, {\n    fullWidth: true,\n    variant: 'contained',\n    color: 'secondary',\n    onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var _yield$actionsMAEM$su, _yield$actionsMAEM$su2;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return actionsMAEM.submit();\n\n            case 2:\n              _context2.t1 = _yield$actionsMAEM$su = _context2.sent;\n              _context2.t0 = _context2.t1 === null;\n\n              if (_context2.t0) {\n                _context2.next = 6;\n                break;\n              }\n\n              _context2.t0 = _yield$actionsMAEM$su === void 0;\n\n            case 6:\n              if (!_context2.t0) {\n                _context2.next = 10;\n                break;\n              }\n\n              _context2.t2 = void 0;\n              _context2.next = 11;\n              break;\n\n            case 10:\n              _context2.t2 = (_yield$actionsMAEM$su2 = _yield$actionsMAEM$su.saveUserAddress) === null || _yield$actionsMAEM$su2 === void 0 ? void 0 : _yield$actionsMAEM$su2.id;\n\n            case 11:\n              if (!_context2.t2) {\n                _context2.next = 15;\n                break;\n              }\n\n              showMessage('操作成功');\n              router.back();\n              actionsMAEM.clearForm();\n\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }))\n  }, \"\\u4FDD\\u5B58\")));\n};","map":null,"metadata":{},"sourceType":"module"}