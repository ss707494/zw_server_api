{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\nimport { MeLayoutBox } from '../components/meLayoutBox';\nimport { MyInfo } from '../components/myInfo';\nimport styled from 'styled-components';\nimport { mpStyle } from '../../../../style/common';\nimport { Space } from '../../../../components/Box/Box';\nimport { useStoreModel } from '../../../../ModelAction/useStore';\nimport { orderHistoryModel } from '../../../m/me/orderHistory/orderHistory';\nimport { dealMaybeNumber, dealMoney, formatDate, fpMergePre } from '../../../../tools/utils';\nimport { Button, Divider } from '@material-ui/core';\nimport { ls } from '../../../../tools/dealKey';\nimport { dealImgUrl } from '../../../../tools/img';\nimport { doc } from '../../../../graphqlTypes/doc';\nimport { DictTypeEnum, PickUpTypeEnum } from '../../../../ss_common/enum';\nimport { modelFactory } from '../../../../ModelAction/modelUtil';\nimport { useRouter } from 'next/router';\nexport const SelfAddressModel = modelFactory('SelfAddressModel', {\n  list: []\n}, {\n  getList: async (value, option) => {\n    var _selfAddress$getDataC, _selfAddress$getDataC2;\n\n    const selfAddress = await option.query(doc.getDataConfig, {\n      data: {\n        type: DictTypeEnum.SelfAddress\n      }\n    });\n    option.setData(fpMergePre({\n      list: (selfAddress === null || selfAddress === void 0 ? void 0 : (_selfAddress$getDataC = selfAddress.getDataConfig) === null || _selfAddress$getDataC === void 0 ? void 0 : (_selfAddress$getDataC2 = _selfAddress$getDataC.value) === null || _selfAddress$getDataC2 === void 0 ? void 0 : _selfAddress$getDataC2.list) || []\n    }));\n  }\n});\nconst Title = styled.div.withConfig({\n  displayName: \"orderHistory__Title\",\n  componentId: \"sc-6504oy-0\"\n})([\"\", \";\"], mpStyle.fontType.l);\nconst OrderBox = styled.div.withConfig({\n  displayName: \"orderHistory__OrderBox\",\n  componentId: \"sc-6504oy-1\"\n})([\"\"]);\nconst OrderTop = styled.div.withConfig({\n  displayName: \"orderHistory__OrderTop\",\n  componentId: \"sc-6504oy-2\"\n})([\"display:flex;align-items:center;justify-content:space-between;\"]);\nconst OrderTime = styled.div.withConfig({\n  displayName: \"orderHistory__OrderTime\",\n  componentId: \"sc-6504oy-3\"\n})([\"\", \";\"], mpStyle.fontType.l);\nconst DetailItem = styled(Button).withConfig({\n  displayName: \"orderHistory__DetailItem\",\n  componentId: \"sc-6504oy-4\"\n})([\"\"]);\nconst OrderPay = styled.div.withConfig({\n  displayName: \"orderHistory__OrderPay\",\n  componentId: \"sc-6504oy-5\"\n})([\"color:\", \";\"], mpStyle.grey);\nconst OrderNum = styled.div.withConfig({\n  displayName: \"orderHistory__OrderNum\",\n  componentId: \"sc-6504oy-6\"\n})([\"color:\", \";\"], mpStyle.grey);\nexport const OrderAddressBox = styled.div.withConfig({\n  displayName: \"orderHistory__OrderAddressBox\",\n  componentId: \"sc-6504oy-7\"\n})([\"display:grid;grid-template-columns:48px 1fr;grid-template-rows:32px 24px;> svg{grid-area:1/1/3/2;align-self:center;font-size:32px;color:\", \";}> section{\", \";align-self:center;}\"], mpStyle.red, mpStyle.fontType.n);\nconst OrderImgBox = styled.div.withConfig({\n  displayName: \"orderHistory__OrderImgBox\",\n  componentId: \"sc-6504oy-8\"\n})([\"display:flex;> img{width:88px;height:140px;margin-right:\", \";}\"], mpStyle.spacePx.n);\nexport const calcAddress = (order, selfAddress) => {\n  if ((order === null || order === void 0 ? void 0 : order.pickUpType) === PickUpTypeEnum.Delivery) {\n    return order === null || order === void 0 ? void 0 : order.userAddress;\n  } else {\n    return selfAddress.find(value => (value === null || value === void 0 ? void 0 : value.id) === (order === null || order === void 0 ? void 0 : order.selfAddressId));\n  }\n};\nexport const OrderHistory = () => {\n  var _stateOrderHistoryMod;\n\n  const router = useRouter();\n  const {\n    state: stateOrderHistoryModel,\n    actions: actionsOrderHistoryModel\n  } = useStoreModel(orderHistoryModel);\n  useEffect(() => {\n    actionsOrderHistoryModel.getList();\n  }, []);\n  const {\n    actions: actionsSelfAddressModel,\n    state: stateSelfAddressModel\n  } = useStoreModel(SelfAddressModel);\n  useEffect(() => {\n    actionsSelfAddressModel.getList();\n  }, []);\n  return __jsx(MeLayoutBox, null, __jsx(MyInfo, null), __jsx(Space, {\n    h: mpStyle.space.n\n  }), __jsx(Title, null, ls('订单历史')), (_stateOrderHistoryMod = stateOrderHistoryModel.orderList.list) === null || _stateOrderHistoryMod === void 0 ? void 0 : _stateOrderHistoryMod.map(order => {\n    var _calcAddress$name, _calcAddress, _order$rOrderProduct, _order$rOrderProduct$, _order$rOrderProduct2;\n\n    return __jsx(OrderBox, {\n      key: `stateOrderHistoryModel.orderList.list?${order === null || order === void 0 ? void 0 : order.id}`\n    }, __jsx(Space, {\n      h: mpStyle.space.xs\n    }), __jsx(OrderTop, null, __jsx(OrderTime, null, formatDate(order === null || order === void 0 ? void 0 : order.createTime, 'YYYY-MM-dd HH:mm')), __jsx(DetailItem, {\n      onClick: () => {\n        var _order$id;\n\n        router.push(`/pc/me/orderDetail/${(_order$id = order === null || order === void 0 ? void 0 : order.id) !== null && _order$id !== void 0 ? _order$id : ''}`);\n      }\n    }, ls('详情'), \" >\")), __jsx(Space, {\n      h: mpStyle.space.xxs\n    }), __jsx(OrderPay, null, dealMoney(order === null || order === void 0 ? void 0 : order.actuallyPaid)), __jsx(Space, {\n      h: mpStyle.space.xxs / 2\n    }), __jsx(OrderNum, null, order === null || order === void 0 ? void 0 : order.number), __jsx(Space, {\n      h: mpStyle.space.xxs\n    }), __jsx(OrderAddressBox, null, __jsx(CheckCircleIcon, null), __jsx(\"section\", null, ls('已自取')), __jsx(\"footer\", null, ls('于'), (_calcAddress$name = (_calcAddress = calcAddress(order, stateSelfAddressModel.list)) === null || _calcAddress === void 0 ? void 0 : _calcAddress.name) !== null && _calcAddress$name !== void 0 ? _calcAddress$name : '')), __jsx(Space, {\n      h: mpStyle.space.xxs\n    }), __jsx(OrderImgBox, null, order === null || order === void 0 ? void 0 : (_order$rOrderProduct = order.rOrderProduct) === null || _order$rOrderProduct === void 0 ? void 0 : (_order$rOrderProduct$ = _order$rOrderProduct.filter(value => {\n      var _value$product, _value$product$img, _value$product$img$;\n\n      return value === null || value === void 0 ? void 0 : (_value$product = value.product) === null || _value$product === void 0 ? void 0 : (_value$product$img = _value$product.img) === null || _value$product$img === void 0 ? void 0 : (_value$product$img$ = _value$product$img[0]) === null || _value$product$img$ === void 0 ? void 0 : _value$product$img$.url;\n    })) === null || _order$rOrderProduct$ === void 0 ? void 0 : _order$rOrderProduct$.map(value1 => {\n      var _value1$product, _value1$product$img, _value1$product$img$, _value1$product2, _value1$product2$img, _value1$product2$img$;\n\n      return __jsx(\"img\", {\n        key: `url_${value1 === null || value1 === void 0 ? void 0 : (_value1$product = value1.product) === null || _value1$product === void 0 ? void 0 : (_value1$product$img = _value1$product.img) === null || _value1$product$img === void 0 ? void 0 : (_value1$product$img$ = _value1$product$img[0]) === null || _value1$product$img$ === void 0 ? void 0 : _value1$product$img$.url}`,\n        src: dealImgUrl(value1 === null || value1 === void 0 ? void 0 : (_value1$product2 = value1.product) === null || _value1$product2 === void 0 ? void 0 : (_value1$product2$img = _value1$product2.img) === null || _value1$product2$img === void 0 ? void 0 : (_value1$product2$img$ = _value1$product2$img[0]) === null || _value1$product2$img$ === void 0 ? void 0 : _value1$product2$img$.url),\n        alt: \"\"\n      });\n    }), ls('共'), \" \", dealMaybeNumber(order === null || order === void 0 ? void 0 : (_order$rOrderProduct2 = order.rOrderProduct) === null || _order$rOrderProduct2 === void 0 ? void 0 : _order$rOrderProduct2.length), \" \", ls('件商品')), __jsx(Space, {\n      h: mpStyle.space.n\n    }), __jsx(Divider, null));\n  }));\n};","map":null,"metadata":{},"sourceType":"module"}