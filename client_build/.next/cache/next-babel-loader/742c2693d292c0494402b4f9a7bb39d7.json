{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* eslint-disable react-hooks/rules-of-hooks */\nimport React, { useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport { AppModuleTypeEnum, DictTypeEnum, RelatedObjTypeEnum } from '../../../ss_common/enum';\nimport { modelFactory } from '../../../ModelAction/modelUtil';\nimport { HomeTabs, HomeTabsModel } from './components/Tabs/Tabs';\nimport CusCarousel from '../../../components/Swipe/Swipe';\nimport { HeaderSearch } from '../../../components/HeaderSearch/HeaderSearch';\nimport { FootBar } from '../../../components/FootBar/FootBar';\nimport { BScroller } from '../../../components/BScroll/BScroller';\nimport { useStoreModel } from '../../../ModelAction/useStore';\nimport { getDataConfig, homeCarouselImgs } from '../../../graphqlTypes/doc';\nimport { formatDate, fpMergePre } from '../../../tools/utils';\nimport styled from 'styled-components';\nimport { dealImgUrl } from '../../../tools/img';\nimport { Space } from '../../../components/Box/Box';\nexport const HomeType = {\n  home: 'home',\n  group: 'group'\n};\nexport const homeCarouselModel = modelFactory('homeCarouselModel', {\n  homeCarouselImgs: []\n}, {\n  getHomeCarousel: async (value, option) => {\n    const res2 = await option.query(getDataConfig, {\n      data: {\n        type: DictTypeEnum.HomeCarousel\n      }\n    }, {});\n\n    const _ref = (res2 === null || res2 === void 0 ? void 0 : res2.getDataConfig) || {},\n          {\n      __typename\n    } = _ref,\n          rest = _objectWithoutProperties(_ref, [\"__typename\"]);\n\n    const homeCarouselDataComfig = await option.query(homeCarouselImgs, {\n      data: _objectSpread({}, rest)\n    }, {});\n    option.setData(fpMergePre({\n      homeCarouselImgs: homeCarouselDataComfig === null || homeCarouselDataComfig === void 0 ? void 0 : homeCarouselDataComfig.homeCarouselImgs\n    }));\n  }\n});\nconst CusSwipeImg = styled.div.withConfig({\n  displayName: \"appModule__CusSwipeImg\",\n  componentId: \"eet2po-0\"\n})([\"> aside{background:rgb(164,164,164,.4);color:white;position:absolute;top:4px;left:4px;padding:8px;border-radius:4px;font-size:small;display:flex;}\"]);\nconst CommonBox = styled.div.withConfig({\n  displayName: \"appModule__CommonBox\",\n  componentId: \"eet2po-1\"\n})([\"padding-top:10px;padding-bottom:120px;display:flex;flex-direction:column;flex-grow:1;flex-shrink:1;overflow:auto;> *{margin-left:10px;margin-right:10px;}\"]);\nconst CusCarouselBox = styled.div.withConfig({\n  displayName: \"appModule__CusCarouselBox\",\n  componentId: \"eet2po-2\"\n})([\"border-radius:10px;overflow:hidden;\"]);\nexport const HomeAppModule = type => function () {\n  const router = useRouter();\n  useEffect(() => {\n    if (router.query.appModule && ![AppModuleTypeEnum.limitTime, AppModuleTypeEnum.mayLike, AppModuleTypeEnum.salesRank, AppModuleTypeEnum.themeSelection, AppModuleTypeEnum.categorySelection, AppModuleTypeEnum.lineRanking, AppModuleTypeEnum.topRanking].includes(router.query.appModule)) {\n      router.replace('/home/[appModule]', '/home/categorySelection', {});\n    }\n  });\n  const {\n    actions: actionsHomeCarouselModel,\n    state: stateHomeCarouselModel\n  } = useStoreModel(homeCarouselModel);\n  const {\n    actions: actionsHomeTabs,\n    state: stateHomeTabsModel\n  } = useStoreModel(HomeTabsModel);\n  useEffect(() => {\n    actionsHomeCarouselModel.getHomeCarousel();\n    actionsHomeTabs.getData();\n  }, [actionsHomeCarouselModel, actionsHomeTabs]);\n  useEffect(() => {\n    actionsHomeTabs.setHomeType(type !== null && type !== void 0 ? type : HomeType.home);\n  }, [actionsHomeTabs]);\n  return __jsx(\"div\", null, __jsx(HeaderSearch, {\n    homeType: type !== null && type !== void 0 ? type : HomeType.home\n  }), __jsx(BScroller, {\n    boxHeight: 'calc(100vh - 65px)'\n  }, __jsx(CommonBox, null, __jsx(CusCarouselBox, null, (() => {\n    var _stateHomeCarouselMod, _stateHomeCarouselMod2, _stateHomeCarouselMod3, _stateHomeCarouselMod4;\n\n    const filterList = (_stateHomeCarouselMod = (_stateHomeCarouselMod2 = stateHomeCarouselModel.homeCarouselImgs) === null || _stateHomeCarouselMod2 === void 0 ? void 0 : (_stateHomeCarouselMod3 = _stateHomeCarouselMod2.value) === null || _stateHomeCarouselMod3 === void 0 ? void 0 : (_stateHomeCarouselMod4 = _stateHomeCarouselMod3.list) === null || _stateHomeCarouselMod4 === void 0 ? void 0 : _stateHomeCarouselMod4.filter(v => !v.isDisabled)) !== null && _stateHomeCarouselMod !== void 0 ? _stateHomeCarouselMod : [];\n    return __jsx(CusCarousel, {\n      height: '160px',\n      dataList: filterList,\n      renderItem: item => {\n        var _item$objData, _item$objData2, _item$objData3, _item$objData4, _item$objData5, _item$objData6, _item$objData7;\n\n        return __jsx(CusSwipeImg, {\n          key: `Carousel_${item.id}`\n        }, __jsx(\"img\", {\n          style: {\n            height: '160px'\n          },\n          src: dealImgUrl(item.imgUrl),\n          alt: \"\"\n        }), __jsx(\"aside\", null, __jsx(\"section\", null, item === null || item === void 0 ? void 0 : (_item$objData = item.objData) === null || _item$objData === void 0 ? void 0 : _item$objData.remark), __jsx(Space, {\n          w: 4\n        }), (item === null || item === void 0 ? void 0 : (_item$objData2 = item.objData) === null || _item$objData2 === void 0 ? void 0 : _item$objData2.effectiveDateStart) && __jsx(\"main\", null, \"[ \", formatDate(item === null || item === void 0 ? void 0 : (_item$objData3 = item.objData) === null || _item$objData3 === void 0 ? void 0 : _item$objData3.effectiveDateStart, 'YYYY/MM/dd'), \" - \", formatDate(item === null || item === void 0 ? void 0 : (_item$objData4 = item.objData) === null || _item$objData4 === void 0 ? void 0 : _item$objData4.effectiveDateEnd, 'YYYY/MM/dd'), \" ]\"), (item === null || item === void 0 ? void 0 : (_item$objData5 = item.objData) === null || _item$objData5 === void 0 ? void 0 : _item$objData5.startTime) && __jsx(\"main\", null, \"[ \", formatDate(item === null || item === void 0 ? void 0 : (_item$objData6 = item.objData) === null || _item$objData6 === void 0 ? void 0 : _item$objData6.startTime, 'YYYY/MM/dd'), \" - \", formatDate(item === null || item === void 0 ? void 0 : (_item$objData7 = item.objData) === null || _item$objData7 === void 0 ? void 0 : _item$objData7.endTime, 'YYYY/MM/dd'), \" ]\")));\n      },\n      onClickItem: index => {\n        var _filterList$index, _filterList$index2, _stateHomeTabsModel$a, _filterList$index3, _stateHomeTabsModel$a2;\n\n        if ((filterList === null || filterList === void 0 ? void 0 : (_filterList$index = filterList[index]) === null || _filterList$index === void 0 ? void 0 : _filterList$index.relatedObjType) === RelatedObjTypeEnum.PromoCode) {\n          router.push('/m/card');\n        }\n\n        if ((filterList === null || filterList === void 0 ? void 0 : (_filterList$index2 = filterList[index]) === null || _filterList$index2 === void 0 ? void 0 : _filterList$index2.relatedObjType) === RelatedObjTypeEnum.PromotionFlashSale && (stateHomeTabsModel === null || stateHomeTabsModel === void 0 ? void 0 : (_stateHomeTabsModel$a = stateHomeTabsModel.appModuleConfig) === null || _stateHomeTabsModel$a === void 0 ? void 0 : _stateHomeTabsModel$a[AppModuleTypeEnum.limitTime])) {\n          router.push(`/m/home/[appModule]`, `/m/home/${AppModuleTypeEnum.limitTime}`);\n        }\n\n        if ((filterList === null || filterList === void 0 ? void 0 : (_filterList$index3 = filterList[index]) === null || _filterList$index3 === void 0 ? void 0 : _filterList$index3.relatedObjType) === RelatedObjTypeEnum.PromotionThemeSelect && (stateHomeTabsModel === null || stateHomeTabsModel === void 0 ? void 0 : (_stateHomeTabsModel$a2 = stateHomeTabsModel.appModuleConfig) === null || _stateHomeTabsModel$a2 === void 0 ? void 0 : _stateHomeTabsModel$a2[AppModuleTypeEnum.themeSelection])) {\n          router.push(`/m/home/[appModule]`, `/m/home/${AppModuleTypeEnum.themeSelection}`);\n        }\n      }\n    });\n  })()), __jsx(\"div\", null, __jsx(HomeTabs, {\n    homeType: type !== null && type !== void 0 ? type : HomeType.home\n  })))), __jsx(FootBar, null));\n};","map":null,"metadata":{},"sourceType":"module"}