(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{"9pAu":function(e,t,n){"use strict";n.r(t);var r=n("rePB"),o=n("KQm4"),i=n("o0o1"),l=n.n(i),u=n("HaE+"),a=n("q1tI"),c=n.n(a),d=n("zfZ/"),s=n.n(d),p=n("roQC"),f=n.n(p),v=n("nOHt"),b=n("+/yG"),m=n("i7FU"),g=n("U81q"),O=n("cBzo"),j=n("K0AU"),y=n("B42p"),h=n("vOnD"),x=n("+vfP"),w=n("ZtJr"),I=n("LXXt"),k=n("Z3vd"),P=n("GLZ+"),D=n("Oj7+"),C=n("oxxF"),N=n("r9w1"),S=n("jjAL"),_=n("PsDL"),L=n("cW92"),Q=n("4Rmy"),F=n("E2gh"),A=n.n(F),z=n("7O+n"),E=n("c+KP"),U=n("q3aC"),M=n("n+/U"),q=n("+kHn"),B=n("OO/1"),R=c.a.createElement;function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=Object(b.c)("orderPageModel",{show:!1},{open:function(e,t){t.setData(Object(O.f)({show:!0}))}}),W=h.a.div.withConfig({displayName:"groupOrderPage__OrderPageBox",componentId:"bhof7w-0"})(["position:fixed;top:0;bottom:0;left:0;right:0;background:white;> footer{position:fixed;bottom:0;box-sizing:border-box;box-shadow:",";width:100vw;text-align:right;}"],w.a.shadow[1]),X=function(){var e,t,n,r,o,i=Object(v.useRouter)(),c=Object(g.b)(Z).state,d=Object(g.b)(V),s=d.actions,p=d.state,f=p.product,b=Object(g.b)(E.c),m=b.state,j=b.actions;Object(a.useEffect)((function(){m.user.id||j.getOrderInfo()}),[]);var y=Object(g.b)(U.b).actions,h=Object(g.b)(M.b).actions,w=m.dealAddressData(m),I=(null===(e=m.payCardList)||void 0===e?void 0:e.find((function(e){return e.id===m.form.paymentMethodCardId})))||{},k=(null!==(t=f.priceOut)&&void 0!==t?t:0)*p.selectNum,F=m.form.pickUpType===Q.f.Delivery&&m.freightConfig.reduce((function(e,t){return e>parseFloat(null===t||void 0===t?void 0:t.freightPay)&&k<parseFloat(null===t||void 0===t?void 0:t.orderMax)?parseFloat(null===t||void 0===t?void 0:t.freightPay):e}),parseFloat(null===(n=m.freightConfig[m.freightConfig.length-1])||void 0===n?void 0:n.freightPay))||0,T=k+F+Object(O.a)(m.form.saleTax),X=.01*T;return c.show&&R(W,null,R(P.b,{style:{padding:"20px"}},R("img",{src:Object(D.a)(null===f||void 0===f?void 0:null===(r=f.img)||void 0===r?void 0:null===(o=r[0])||void 0===o?void 0:o.url),alt:""}),R("main",null,null===f||void 0===f?void 0:f.name,null===f||void 0===f?void 0:f.weight,null===f||void 0===f?void 0:f.unit),R("section",null,null===f||void 0===f?void 0:f.remark),R("footer",null,R(C.d,{product:f}),R("span",null,p.selectNum,Object(x.a)("\u4efd")))),R(N.a,{style:{margin:"16px",width:"calc(100vw - 32px)"},fullWidth:!0,label:Object(x.a)("\u8fd0\u9001\u65b9\u5f0f"),select:!0,value:m.form.pickUpType,onChange:function(e){j.setForm(["pickUpType",e.target.value]),j.setForm(["addressId",m.initAddressId(Object(O.e)(m,{form:{pickUpType:e.target.value}}))])}},R(S.a,{value:Q.f.Self},Object(x.a)(Object(Q.h)(Q.f.Self))),R(S.a,{value:Q.f.Delivery},Object(x.a)(Object(Q.h)(Q.f.Delivery)))),R(z.a,null,R("main",null,R("header",null,"".concat(w.combineAddress)),R("footer",null,"".concat(w.name," ").concat(w.contactInformation))),R("aside",null,R(_.a,{onClick:Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.openClick();case 2:(t=e.sent)&&j.setForm(["addressId",t]);case 4:case"end":return e.stop()}}),e)})))},R(A.a,null)))),R(z.d,null,R(L.b,{w:20}),Object(x.a)("\u4ed8\u6b3e\u65b9\u5f0f")),R(z.b,null,R("header",null,I.name),R("footer",null,I.number),R("aside",null,R(_.a,{onClick:Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.openClick();case 2:(t=e.sent)&&j.setForm(["paymentMethodCardId",t]);case 4:case"end":return e.stop()}}),e)})))},R(A.a,null)))),R(U.a,null),R(M.a,null),R(z.e,null,R("header",null,Object(x.a)("\u8d2d\u7269\u8f66\u603b\u8ba1")),R("footer",null,Object(O.b)(k))),F>0&&R(z.e,null,R("header",null,Object(x.a)("\u8fd0\u8d39")),R("footer",null,Object(O.b)(F))),R(z.e,null,R("header",null,Object(x.a)("\u4efd\u6570\u6298\u6263")),R("footer",null,p.numDiscount)),R(z.e,null,R("header",null,Object(x.a)("\u6210\u56e2\u6298\u4e0a\u6298")),R("footer",null,p.groupDiscount)),R(z.e,{style:{fontSize:"18px"}},R("header",null,Object(x.a)("\u8ba2\u5355\u603b\u989d")),R("footer",null,Object(O.b)(T))),R(L.b,{h:60}),R("footer",null,R(q.a,{variant:"contained",color:"secondary",onClick:Object(u.a)(l.a.mark((function e(){var t,n,r,o,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.submit({orderInfoItemInput:G(G({},m.form),{},{generateCoin:X,actuallyPaid:T,transportationCosts:F,subtotal:k,currentUserLevel:null===(t=m.user.userInfo)||void 0===t?void 0:t.userLevel,rOrderProduct:[{count:p.selectNum,productId:null===f||void 0===f?void 0:f.id,product:f}]})});case 2:if(!(null===(r=e.sent)||void 0===r?void 0:null===(n=r.saveGroupOrder)||void 0===n?void 0:n.id)){e.next=10;break}return Object(B.b)("\u64cd\u4f5c\u6210\u529f \u5c06\u524d\u5f80\u4ed8\u6b3e"),u=Object(O.c)({orderId:null===r||void 0===r?void 0:null===(o=r.saveGroupOrder)||void 0===o?void 0:o.id}),e.next=8,i.replace("/pay".concat(u),"/pay".concat(u));case 8:j.clearData(),j.getList();case 10:case"end":return e.stop()}}),e)})))},Object(x.a)("\u63d0\u4ea4\u8ba2\u5355"))))||null},H=c.a.createElement;function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=Object(b.c)("groupProductModel",{product:{},groupQueueList:[],selectNum:0,selectQueueId:"",numDiscount:1,groupDiscount:1},{getData:function(){var e=Object(u.a)(l.a.mark((function e(t,n){var r,o,i,u,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.query(m.b.productListByIds,{ids:[t]});case 2:return a=e.sent,e.next=5,n.query(m.b.groupQueueList,{groupQueueItemInput:{product:{id:t}}});case 5:c=e.sent,n.setData(Object(O.f)({product:null!==(r=null===a||void 0===a?void 0:null===(o=a.productListByIds)||void 0===o?void 0:o.list[0])&&void 0!==r?r:{},groupQueueList:null!==(i=null===c||void 0===c?void 0:null===(u=c.groupQueueList)||void 0===u?void 0:u.sort((function(e,t){var n,r;return(null!==(n=e.sumFillAmount)&&void 0!==n?n:0)-(null!==(r=t.sumFillAmount)&&void 0!==r?r:0)})))&&void 0!==i?i:[]}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),updateSelectNum:function(e,t){var n,r,i;t.setData(Object(O.f)(e===t.data.selectNum?{selectNum:0,selectQueueId:""}:{selectNum:e,selectQueueId:null!==(n=null===(r=Object(o.a)(t.data.groupQueueList).reverse())||void 0===r?void 0:null===(i=r.find((function(n){var r,o,i,l;return(null!==(r=n.sumFillAmount)&&void 0!==r?r:0)+e<=(null!==(o=null===(i=t.data)||void 0===i?void 0:null===(l=i.product)||void 0===l?void 0:l.groupPrecision)&&void 0!==o?o:0)})))||void 0===i?void 0:i.id)&&void 0!==n?n:""}))},submit:function(){var e=Object(u.a)(l.a.mark((function e(t,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.orderInfoItemInput,e.next=3,n.mutate(m.b.saveGroupOrder,{orderInfoItemInput:K({},r),groupOrderItemInput:{orderGroupAmount:n.data.selectNum},groupQueueItemInput:K({product:n.data.product},n.data.selectQueueId?{id:n.data.selectQueueId}:{})});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),Y=h.a.div.withConfig({displayName:"id__PriceRed",componentId:"sc-1c5vpsf-0"})(["background:",";color:white;display:grid;grid-template-columns:1fr 120px;grid-template-rows:repeat(2,30px);align-items:center;> main{grid-area:1/1/3/2;padding-left:20px;> span{margin-left:16px;}}"],w.a.red),$=h.a.div.withConfig({displayName:"id__Name",componentId:"sc-1c5vpsf-1"})(["padding:16px 20px;display:flex;align-items:flex-end;> main{font-size:22px;margin-right:8px;flex-shrink:0;}> section{> span{padding:0 4px;background:",";border-radius:4px;position:relative;bottom:-4px;margin-left:8px;display:inline-flex;align-items:center;}}"],I.a[700]),ee=function(){return H(s.a,{fontSize:"small",style:{color:"#FDD334"}})},te=h.a.header.withConfig({displayName:"id__Title",componentId:"sc-1c5vpsf-2"})(["font-size:20px;"]),ne=h.a.div.withConfig({displayName:"id__GroupQueueBox",componentId:"sc-1c5vpsf-3"})(["padding:16px;"]),re=h.a.div.withConfig({displayName:"id__SmartMatch",componentId:"sc-1c5vpsf-4"})(["padding:16px 16px 90px;> section{margin-top:8px;display:flex;align-items:center;}> main{}"]),oe=h.a.div.withConfig({displayName:"id__Price",componentId:"sc-1c5vpsf-5"})(["margin-top:8px;display:flex;justify-content:space-between;align-items:center;> main{font-weight:bold;}> main,section{> *{text-align:center;}}"]),ie=h.a.div.withConfig({displayName:"id__Submit",componentId:"sc-1c5vpsf-6"})(["position:fixed;height:60px;bottom:0;width:100vw;background:white;border-top:1px solid ",";display:flex;align-items:center;justify-content:space-between;box-shadow:",";> aside{padding-left:16px;color:",";}"],w.a.red,w.a.shadow[1],w.a.red),le=h.a.div.withConfig({displayName:"id__GroupQueueListBox",componentId:"sc-1c5vpsf-7"})(["margin-top:16px;border-radius:8px;background:",";display:flex;justify-content:space-between;align-items:center;padding:0 8px;"],(function(e){return e.select?"linear-gradient(to right, ".concat(w.a.red,", #FC7361)"):I.a[200]}));t.default=function(){var e,t,n,r,i,l=null!==(e=null===(t=Object(v.useRouter)().query)||void 0===t?void 0:t.id)&&void 0!==e?e:"",u=Object(g.b)(V),c=u.actions,d=u.state;Object(a.useEffect)((function(){c.getData(l)}),[l]);var p=Object(g.b)(Z).actions,b=d.product;return console.log(d.groupQueueList),H("div",null,H(y.a,{title:"\u4ea7\u54c1\u8be6\u60c5"}),H(j.a,{height:"240px",dataList:null===b||void 0===b?void 0:null===(n=b.img)||void 0===n?void 0:n.map((function(e){return K(K({},e),{},{imgUrl:null===e||void 0===e?void 0:e.url})}))}),H(Y,null,H("main",null,Object(x.a)("\u57fa\u51c6\u4ef7\u683c"),H("span",null,Object(O.b)(b.priceOut),"/",b.packingUnitString)),H("aside",null,Object(x.a)("\u5df2\u6210\u56e2"),d.groupQueueList.filter((function(e){return e.sumFillAmount===(null===b||void 0===b?void 0:b.groupPrecision)})).length,Object(x.a)("\u5355")),H("aside",null,Object(x.a)("\u62fc\u56e2\u4e2d"),d.groupQueueList.filter((function(e){var t,n;return(null!==(t=e.sumFillAmount)&&void 0!==t?t:0)<(null!==(n=null===b||void 0===b?void 0:b.groupPrecision)&&void 0!==n?n:0)})).length,Object(x.a)("\u5355"))),H($,null,H("main",null,b.name),H("section",null,b.groupRemark,"/",b.groupAmount,b.groupAmountUnitString,H("br",null),Object(x.a)("\u5206\u56e2\u7cbe\u5ea6"),H("span",null,Object(o.a)(Array(b.groupPrecision)).map((function(e,t){return t})).map((function(e){return H(ee,{key:e})}))))),H(ne,null,H(te,null,Object(x.a)("\u62fc\u56e2\u4e2d")),d.groupQueueList.map((function(e){var t,n=e.id===d.selectQueueId;return H(le,{select:n,key:"GroupQueueListBox".concat(e.id)},H("aside",null,Object(o.a)(Array(b.groupPrecision)).map((function(e,t){return t})).map((function(t){var r;return t+1>(null!==(r=e.sumFillAmount)&&void 0!==r?r:0)+(n?d.selectNum:0)?H(f.a,{key:"clickStar".concat(t),fontSize:"large",onClick:function(){return c.updateSelectNum(t+1)},style:{color:n?"#fff":"#000"}}):H(s.a,{key:"clickStar".concat(t),style:{color:"#FDD334"},fontSize:"large",onClick:function(){return c.updateSelectNum(t+1)}})}))),H("footer",null,Object(x.a)((null!==(t=e.sumFillAmount)&&void 0!==t?t:0)+(n?d.selectNum:0)===b.groupPrecision?"\u6210\u56e2\u5566":"\u672a\u6210\u56e2")))}))),H(re,null,H("header",null,H(te,null,Object(x.a)("\u667a\u80fd\u5339\u914d"))),H("section",null,Object(x.a)("\u8bf7\u70b9\u51fb"),H(f.a,null),Object(x.a)("\u786e\u5b9a\u60a8\u9700\u8981\u7684\u4efd\u6570")),H("main",null,Object(o.a)(Array(b.groupPrecision)).map((function(e,t){return t})).map((function(e){return e+1>d.selectNum?H(f.a,{key:"clickStar".concat(e),fontSize:"large",onClick:function(){return c.updateSelectNum(e+1)}}):H(s.a,{key:"clickStar".concat(e),style:{color:"#FDD334"},fontSize:"large",onClick:function(){return c.updateSelectNum(e+1)}})}))),H(oe,null,H("main",null,H("header",null,Object(O.b)((null!==(r=b.priceOut)&&void 0!==r?r:0)*d.selectNum*d.numDiscount*d.groupDiscount)),H("footer",null,Object(x.a)("\u6298\u540e\u4ef7\u683c"))),H("div",null,"="),H("section",null,H("header",null,Object(O.b)((null!==(i=b.priceOut)&&void 0!==i?i:0)*d.selectNum)),H("footer",null,Object(x.a)("\u57fa\u51c6\u4ef7\u683c"))),H("div",null,"x"),H("section",null,H("header",null,d.numDiscount),H("footer",null,Object(x.a)("\u4efd\u6570\u6298\u6263"))),H("div",null,"x"),H("section",null,H("header",null,d.groupDiscount),H("footer",null,Object(x.a)("\u6210\u56e2\u6298\u4e0a\u6298"))))),H(ie,null,H("aside",null,Object(x.a)("\u9009\u62e9\u4e86"),d.selectNum,Object(x.a)("\u4efd")),H(k.a,{disabled:0===d.selectNum,style:{height:"100%",padding:"0 32px",borderRadius:"0",fontSize:"18px"},color:"secondary",variant:"contained",onClick:function(){p.open()}},Object(x.a)("\u53bb\u7ed3\u7b97"))),H(X,null))}},rOW0:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/groupProduct/[id]",function(){return n("9pAu")}])},roQC:function(e,t,n){"use strict";var r=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("q1tI")),i=(0,r(n("8/g6")).default)(o.default.createElement("path",{d:"M19.65 9.04l-4.84-.42-1.89-4.45c-.34-.81-1.5-.81-1.84 0L9.19 8.63l-4.83.41c-.88.07-1.24 1.17-.57 1.75l3.67 3.18-1.1 4.72c-.2.86.73 1.54 1.49 1.08l4.15-2.5 4.15 2.51c.76.46 1.69-.22 1.49-1.08l-1.1-4.73 3.67-3.18c.67-.58.32-1.68-.56-1.75zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"}),"StarBorderRounded");t.default=i},"zfZ/":function(e,t,n){"use strict";var r=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("q1tI")),i=(0,r(n("8/g6")).default)(o.default.createElement("path",{d:"M12 17.27l4.15 2.51c.76.46 1.69-.22 1.49-1.08l-1.1-4.72 3.67-3.18c.67-.58.31-1.68-.57-1.75l-4.83-.41-1.89-4.46c-.34-.81-1.5-.81-1.84 0L9.19 8.63l-4.83.41c-.88.07-1.24 1.17-.57 1.75l3.67 3.18-1.1 4.72c-.2.86.73 1.54 1.49 1.08l4.15-2.5z"}),"StarRounded");t.default=i}},[["rOW0",1,0,5,2,3,4,6,7,8,9,10,11,12,13]]]);